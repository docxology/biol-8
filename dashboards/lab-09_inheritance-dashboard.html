<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lab 9 Dashboard: Inheritance | BIOL-8</title>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    :root {
      --bg: #f0f2f5;
      --card: #fff;
      --sidebar: #1a1a2e;
      --sidebar-hover: #252545;
      --accent: #c41e3a;
      --accent-light: #e8354f;
      --blue: #2563eb;
      --blue-light: #3b82f6;
      --green: #16a34a;
      --amber: #d97706;
      --purple: #7c3aed;
      --text: #1a1a1a;
      --text-muted: #6b7280;
      --border: #e5e7eb;
      --radius: 10px;
      --shadow: 0 1px 3px rgba(0, 0, 0, .08);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1);
      --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
      --mono: 'SF Mono', 'Cascadia Code', 'Consolas', monospace
    }

    html {
      scroll-behavior: smooth
    }

    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      line-height: 1.6
    }

    .layout {
      display: flex;
      min-height: 100vh
    }

    .sidebar {
      width: 260px;
      background: var(--sidebar);
      color: #e2e8f0;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      display: flex;
      flex-direction: column
    }

    .sidebar-header {
      padding: 24px 20px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, .1)
    }

    .sidebar-header h1 {
      font-size: 15px;
      font-weight: 700;
      color: #fff;
      letter-spacing: .5px
    }

    .sidebar-header p {
      font-size: 12px;
      color: #94a3b8;
      margin-top: 4px
    }

    .sidebar-nav {
      flex: 1;
      padding: 12px 0
    }

    .sidebar-nav a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 20px;
      color: #94a3b8;
      text-decoration: none;
      font-size: 13px;
      font-weight: 500;
      transition: all .15s;
      border-left: 3px solid transparent
    }

    .sidebar-nav a:hover {
      background: var(--sidebar-hover);
      color: #e2e8f0
    }

    .sidebar-nav a.active {
      color: #fff;
      background: var(--sidebar-hover);
      border-left-color: var(--accent)
    }

    .sidebar-nav .nav-num {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      background: rgba(255, 255, 255, .08);
      flex-shrink: 0
    }

    .sidebar-nav a.active .nav-num {
      background: var(--accent);
      color: #fff
    }

    .sidebar-footer {
      padding: 16px 20px;
      border-top: 1px solid rgba(255, 255, 255, .1);
      font-size: 11px;
      color: #64748b
    }

    .main {
      margin-left: 260px;
      flex: 1;
      padding: 32px;
      max-width: 1200px
    }

    .section {
      margin-bottom: 40px;
      scroll-margin-top: 24px
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px
    }

    .section-num {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: var(--accent);
      color: #fff;
      font-weight: 800;
      font-size: 16px;
      flex-shrink: 0
    }

    .section-title {
      font-size: 22px;
      font-weight: 700
    }

    .section-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 2px
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 24px;
      margin-bottom: 16px;
      border: 1px solid var(--border);
      animation: fadeUp .5s ease
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(16px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    .card-title {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px
    }

    .card-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px
    }

    @media(max-width:900px) {
      .card-row {
        grid-template-columns: 1fr
      }
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all .15s;
      font-family: var(--font)
    }

    .btn-primary {
      background: var(--accent);
      color: #fff
    }

    .btn-primary:hover {
      background: var(--accent-light);
      transform: translateY(-1px);
      box-shadow: var(--shadow-lg)
    }

    .btn-secondary {
      background: var(--blue);
      color: #fff
    }

    .btn-secondary:hover {
      background: var(--blue-light)
    }

    .btn-outline {
      background: transparent;
      color: var(--text);
      border: 2px solid var(--border)
    }

    .btn-outline:hover {
      border-color: var(--accent);
      color: var(--accent)
    }

    .btn-sm {
      padding: 6px 14px;
      font-size: 12px
    }

    .btn-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 12px 0
    }

    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin: 12px 0
    }

    .stat-box {
      text-align: center;
      padding: 14px 8px;
      border-radius: 8px;
      background: #f8fafc;
      border: 1px solid var(--border);
      transition: transform .2s
    }

    .stat-box:hover {
      transform: scale(1.03)
    }

    .stat-box .stat-val {
      font-size: 28px;
      font-weight: 800;
      font-family: var(--mono)
    }

    .stat-box .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
      font-weight: 600;
      letter-spacing: .5px
    }

    .stat-accent .stat-val {
      color: var(--accent)
    }

    .stat-blue .stat-val {
      color: var(--blue)
    }

    .stat-green .stat-val {
      color: var(--green)
    }

    .stat-amber .stat-val {
      color: var(--amber)
    }

    .stat-purple .stat-val {
      color: var(--purple)
    }

    .chart-wrap {
      position: relative;
      width: 100%;
      margin: 8px 0
    }

    .chart-wrap canvas {
      width: 100% !important;
      display: block;
      border-radius: 6px
    }

    .hero {
      background: linear-gradient(135deg, #1a1a2e 0%, #2d1b3d 50%, #3b1a2e 100%);
      color: #fff;
      border-radius: var(--radius);
      padding: 36px;
      margin-bottom: 32px;
      position: relative;
      overflow: hidden
    }

    .hero::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(196, 30, 58, .15) 0%, transparent 70%);
      pointer-events: none;
      animation: heroPulse 4s ease-in-out infinite alternate
    }

    @keyframes heroPulse {
      0% {
        transform: scale(1);
        opacity: .5
      }

      100% {
        transform: scale(1.2);
        opacity: 1
      }
    }

    .hero h2 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 8px
    }

    .hero p {
      font-size: 15px;
      color: #cbd5e1;
      max-width: 600px;
      line-height: 1.7
    }

    .hero .bio-tags {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap
    }

    .hero .bio-tag {
      padding: 4px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      background: rgba(255, 255, 255, .1);
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255, 255, 255, .15)
    }

    .punnett-grid {
      display: grid;
      grid-template-columns: 80px 1fr 1fr;
      grid-template-rows: 60px 1fr 1fr;
      gap: 4px;
      max-width: 340px;
      margin: 12px auto
    }

    .punnett-grid .pg-cell {
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      font-weight: 700;
      font-size: 20px;
      min-height: 70px;
      transition: all .3s
    }

    .pg-corner {
      background: transparent !important
    }

    .pg-header {
      background: #1a1a2e;
      color: #fff
    }

    .pg-AA {
      background: #fce7f3;
      color: #9d174d;
      border: 2px solid #f9a8d4
    }

    .pg-Aa {
      background: #fef3c7;
      color: #92400e;
      border: 2px solid #fcd34d
    }

    .pg-aa {
      background: #dbeafe;
      color: #1e40af;
      border: 2px solid #93c5fd
    }

    .pg-highlight {
      box-shadow: 0 0 0 3px var(--accent), 0 0 12px rgba(196, 30, 58, .3);
      transform: scale(1.05);
      z-index: 1
    }

    .analysis-result {
      background: #f8fafc;
      border-radius: 8px;
      padding: 16px;
      margin: 10px 0;
      border-left: 4px solid var(--blue);
      font-size: 14px
    }

    .ped-person {
      cursor: pointer;
      transition: all .2s
    }

    .ped-person:hover {
      filter: brightness(1.1);
      transform: scale(1.05)
    }

    .dna-strand {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      opacity: .1;
      font-size: 80px;
      animation: dnaRotate 8s linear infinite
    }

    @keyframes dnaRotate {
      0% {
        transform: translateY(-50%) rotate(0deg)
      }

      100% {
        transform: translateY(-50%) rotate(360deg)
      }
    }

    select.form-select {
      padding: 8px 12px;
      border-radius: 8px;
      border: 2px solid var(--border);
      font-family: var(--font);
      font-size: 13px;
      font-weight: 600;
      background: #fff;
      cursor: pointer;
      transition: border-color .15s
    }

    select.form-select:focus {
      outline: none;
      border-color: var(--accent)
    }

    @media(max-width:768px) {
      .sidebar {
        display: none
      }

      .main {
        margin-left: 0;
        padding: 16px
      }
    }
  </style>
</head>

<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>BIOL-8: Human Biology</h1>
        <p>Lab 9 &mdash; Inheritance</p>
      </div>
      <nav class="sidebar-nav">
        <a href="#hero" class="active"><span class="nav-num">&bull;</span> Overview</a>
        <a href="#part1"><span class="nav-num">1</span> Key Concepts</a>
        <a href="#part2"><span class="nav-num">2</span> Coin Toss Simulator</a>
        <a href="#part3"><span class="nav-num">3</span> Albinism Crosses</a>
        <a href="#part4"><span class="nav-num">4</span> Color Blindness</a>
        <a href="#part5"><span class="nav-num">5</span> Family Pedigree</a>
      </nav>
      <div class="sidebar-footer">Interactive Lab Dashboard<br>&copy; 2026 BIOL-8</div>
    </aside>
    <div class="main">

      <div class="hero" id="hero">
        <div class="dna-strand">üß¨</div>
        <h2>Genetics &amp; Inheritance</h2>
        <p>Interactive simulations exploring how traits are passed from parents to offspring. Flip coins to model allele
          segregation, build Punnett squares for albinism and color blindness, and trace cystic fibrosis through a
          family pedigree.</p>
        <div class="bio-tags">
          <span class="bio-tag">üß¨ Mendelian Genetics</span>
          <span class="bio-tag">üé≤ Probability</span>
          <span class="bio-tag">üëÅÔ∏è Color Blindness</span>
          <span class="bio-tag">üë®‚Äçüë©‚Äçüëß Pedigree</span>
        </div>
      </div>

      <!-- PART 1: KEY CONCEPTS -->
      <div class="section" id="part1">
        <div class="section-header">
          <div class="section-num">1</div>
          <div>
            <div class="section-title">Key Concepts</div>
            <div class="section-subtitle">Master the essential vocabulary of genetics</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">üìñ Terminology Flash Cards</div>
          <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Click a card to flip it and reveal the
            definition.</p>
          <div id="flashcards" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;">
          </div>
        </div>
        <div class="card">
          <div class="card-title">‚úÖ Quick Quiz</div>
          <div id="quiz-area"></div>
          <div class="btn-group"><button class="btn btn-primary" onclick="checkQuiz()">Check Answers</button><button
              class="btn btn-outline" onclick="resetQuiz()">Reset</button></div>
          <div id="quiz-result"></div>
        </div>
      </div>

      <!-- PART 2: COIN TOSS -->
      <div class="section" id="part2">
        <div class="section-header">
          <div class="section-num">2</div>
          <div>
            <div class="section-title">Coin Toss Simulator</div>
            <div class="section-subtitle">Model allele segregation with Aa √ó Aa crosses</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">üé≤ Flip Coins</div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="coinFlip(1)">Flip 1</button>
            <button class="btn btn-secondary" onclick="coinFlip(5)">Flip 5</button>
            <button class="btn btn-secondary" onclick="coinFlip(20)">Flip 20</button>
            <button class="btn btn-secondary" onclick="coinFlip(100)">Flip 100</button>
            <button class="btn btn-outline" onclick="coinReset()">Reset</button>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-accent">
              <div class="stat-val" id="coin-aa">0</div>
              <div class="stat-label">AA</div>
            </div>
            <div class="stat-box stat-amber">
              <div class="stat-val" id="coin-Aa">0</div>
              <div class="stat-label">Aa</div>
            </div>
            <div class="stat-box stat-blue">
              <div class="stat-val" id="coin-bb">0</div>
              <div class="stat-label">aa</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="coin-total">0</div>
              <div class="stat-label">Total</div>
            </div>
          </div>
          <div class="card-row">
            <div>
              <div class="card-title" style="font-size:13px;">Observed vs Expected</div>
              <div class="chart-wrap"><canvas id="coin-bar" height="240"></canvas></div>
            </div>
            <div>
              <div class="card-title" style="font-size:13px;">Convergence Over Time</div>
              <div class="chart-wrap"><canvas id="coin-line" height="240"></canvas></div>
            </div>
          </div>
          <div id="coin-analysis"></div>
        </div>
      </div>

      <!-- PART 3: ALBINISM -->
      <div class="section" id="part3">
        <div class="section-header">
          <div class="section-num">3</div>
          <div>
            <div class="section-title">Punnett Squares ‚Äî Albinism</div>
            <div class="section-subtitle">Predict offspring for autosomal recessive albinism</div>
          </div>
        </div>
        <div class="card-row">
          <div class="card">
            <div class="card-title">Cross 1: AA √ó aa</div>
            <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Homozygous normal √ó Albino</p>
            <div class="punnett-grid">
              <div class="pg-cell pg-corner"></div>
              <div class="pg-cell pg-header">a</div>
              <div class="pg-cell pg-header">a</div>
              <div class="pg-cell pg-header">A</div>
              <div class="pg-cell pg-Aa" id="alb1-00">Aa</div>
              <div class="pg-cell pg-Aa" id="alb1-01">Aa</div>
              <div class="pg-cell pg-header">A</div>
              <div class="pg-cell pg-Aa" id="alb1-10">Aa</div>
              <div class="pg-cell pg-Aa" id="alb1-11">Aa</div>
            </div>
            <div class="analysis-result" style="border-left-color:var(--green)"><strong>Result:</strong> 100% Aa ‚Äî All
              offspring are carriers with normal pigmentation. None have albinism.</div>
          </div>
          <div class="card">
            <div class="card-title">Cross 2: Aa √ó Aa</div>
            <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Two carriers</p>
            <div class="punnett-grid">
              <div class="pg-cell pg-corner"></div>
              <div class="pg-cell pg-header">A</div>
              <div class="pg-cell pg-header">a</div>
              <div class="pg-cell pg-header">A</div>
              <div class="pg-cell pg-AA" id="alb2-00">AA</div>
              <div class="pg-cell pg-Aa" id="alb2-01">Aa</div>
              <div class="pg-cell pg-header">a</div>
              <div class="pg-cell pg-Aa" id="alb2-10">Aa</div>
              <div class="pg-cell pg-aa" id="alb2-11">aa</div>
            </div>
            <div class="stat-grid">
              <div class="stat-box stat-accent">
                <div class="stat-val">25%</div>
                <div class="stat-label">AA</div>
              </div>
              <div class="stat-box stat-amber">
                <div class="stat-val">50%</div>
                <div class="stat-label">Aa (carrier)</div>
              </div>
              <div class="stat-box stat-blue">
                <div class="stat-val">25%</div>
                <div class="stat-label">aa (albino)</div>
              </div>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">üß™ Interactive Cross Builder</div>
          <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:center;margin-bottom:12px;">
            <div>
              <div style="font-size:12px;font-weight:600;color:var(--text-muted);margin-bottom:4px;">PARENT 1</div>
              <select class="form-select" id="alb-p1" onchange="albUpdate()">
                <option value="AA">AA (Normal)</option>
                <option value="Aa" selected>Aa (Carrier)</option>
                <option value="aa">aa (Albino)</option>
              </select>
            </div>
            <div style="font-size:24px;padding-top:16px;">√ó</div>
            <div>
              <div style="font-size:12px;font-weight:600;color:var(--text-muted);margin-bottom:4px;">PARENT 2</div>
              <select class="form-select" id="alb-p2" onchange="albUpdate()">
                <option value="AA">AA (Normal)</option>
                <option value="Aa" selected>Aa (Carrier)</option>
                <option value="aa">aa (Albino)</option>
              </select>
            </div>
          </div>
          <div id="alb-dynamic-grid"></div>
          <div id="alb-dynamic-stats"></div>
          <div class="btn-group"><button class="btn btn-primary" onclick="albSimulate(20)">Simulate 20
              Offspring</button><button class="btn btn-outline" onclick="albResetSim()">Reset</button></div>
          <div class="chart-wrap"><canvas id="alb-sim-chart" height="220"></canvas></div>
        </div>
      </div>

      <!-- PART 4: COLOR BLINDNESS -->
      <div class="section" id="part4">
        <div class="section-header">
          <div class="section-num">4</div>
          <div>
            <div class="section-title">Sex-Linked Inheritance ‚Äî Color Blindness</div>
            <div class="section-subtitle">X-linked recessive trait affecting males more than females</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">üëÅÔ∏è Genotype Reference</div>
          <table style="width:100%;border-collapse:collapse;font-size:14px;margin:8px 0;">
            <thead>
              <tr style="background:#1a1a2e;color:#fff;">
                <th style="padding:10px;text-align:left;">Genotype</th>
                <th style="padding:10px;">Sex</th>
                <th style="padding:10px;">Phenotype</th>
              </tr>
            </thead>
            <tbody>
              <tr style="background:#f0fdf4;">
                <td style="padding:8px 10px;font-weight:700;">X<sup>C</sup>X<sup>C</sup></td>
                <td style="padding:8px;text-align:center;">Female</td>
                <td style="padding:8px;">Normal vision</td>
              </tr>
              <tr style="background:#fffbeb;">
                <td style="padding:8px 10px;font-weight:700;">X<sup>C</sup>X<sup>c</sup></td>
                <td style="padding:8px;text-align:center;">Female</td>
                <td style="padding:8px;">Normal vision <span
                    style="color:var(--amber);font-weight:600;">(carrier)</span></td>
              </tr>
              <tr style="background:#fef2f2;">
                <td style="padding:8px 10px;font-weight:700;">X<sup>c</sup>X<sup>c</sup></td>
                <td style="padding:8px;text-align:center;">Female</td>
                <td style="padding:8px;color:var(--accent);font-weight:600;">Color blind</td>
              </tr>
              <tr style="background:#f0fdf4;">
                <td style="padding:8px 10px;font-weight:700;">X<sup>C</sup>Y</td>
                <td style="padding:8px;text-align:center;">Male</td>
                <td style="padding:8px;">Normal vision</td>
              </tr>
              <tr style="background:#fef2f2;">
                <td style="padding:8px 10px;font-weight:700;">X<sup>c</sup>Y</td>
                <td style="padding:8px;text-align:center;">Male</td>
                <td style="padding:8px;color:var(--accent);font-weight:600;">Color blind</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-title">üî¨ Cross: Carrier Mother √ó Normal Father</div>
          <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">X<sup>C</sup>X<sup>c</sup> √ó
            X<sup>C</sup>Y</p>
          <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:center;margin-bottom:12px;">
            <div>
              <div style="font-size:12px;font-weight:600;color:var(--text-muted);margin-bottom:4px;">MOTHER</div>
              <select class="form-select" id="cb-mom" onchange="cbUpdate()">
                <option value="XCXC">X^C X^C (Normal)</option>
                <option value="XCXc" selected>X^C X^c (Carrier)</option>
                <option value="XcXc">X^c X^c (Color blind)</option>
              </select>
            </div>
            <div style="font-size:24px;padding-top:16px;">√ó</div>
            <div>
              <div style="font-size:12px;font-weight:600;color:var(--text-muted);margin-bottom:4px;">FATHER</div>
              <select class="form-select" id="cb-dad" onchange="cbUpdate()">
                <option value="XCY" selected>X^C Y (Normal)</option>
                <option value="XcY">X^c Y (Color blind)</option>
              </select>
            </div>
          </div>
          <div id="cb-punnett"></div>
          <div id="cb-stats"></div>
          <div class="btn-group"><button class="btn btn-primary" onclick="cbSimulate(100)">Simulate 100
              Offspring</button><button class="btn btn-outline" onclick="cbResetSim()">Reset</button></div>
          <div class="chart-wrap"><canvas id="cb-sim-chart" height="240"></canvas></div>
        </div>
      </div>

      <!-- PART 5: PEDIGREE -->
      <div class="section" id="part5">
        <div class="section-header">
          <div class="section-num">5</div>
          <div>
            <div class="section-title">Family Pedigree ‚Äî Cystic Fibrosis</div>
            <div class="section-subtitle">Trace autosomal recessive CF through three generations</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Interactive Pedigree</div>
          <p style="font-size:13px;color:var(--text-muted);margin-bottom:4px;">Click on any person to toggle their
            affected status. The analyzer will deduce genotypes.</p>
          <div class="chart-wrap"><canvas id="ped-canvas" height="360"></canvas></div>
          <div class="btn-group"><button class="btn btn-primary" onclick="pedReset()">Reset to Scenario</button><button
              class="btn btn-secondary" onclick="pedRevealGenotypes()">Reveal Genotypes</button></div>
          <div id="ped-analysis"></div>
        </div>
        <div class="card">
          <div class="card-title">üìä Carrier Risk Calculator</div>
          <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">If both parents are carriers (Ff √ó Ff),
            simulate offspring outcomes:</p>
          <div class="btn-group"><button class="btn btn-primary" onclick="cfSimulate(20)">Simulate 20
              Children</button><button class="btn btn-secondary" onclick="cfSimulate(100)">Simulate 100</button><button
              class="btn btn-outline" onclick="cfReset()">Reset</button></div>
          <div class="stat-grid">
            <div class="stat-box stat-green">
              <div class="stat-val" id="cf-FF">0</div>
              <div class="stat-label">FF (Unaffected)</div>
            </div>
            <div class="stat-box stat-amber">
              <div class="stat-val" id="cf-Ff">0</div>
              <div class="stat-label">Ff (Carrier)</div>
            </div>
            <div class="stat-box stat-accent">
              <div class="stat-val" id="cf-ff">0</div>
              <div class="stat-label">ff (CF)</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="cf-chart" height="220"></canvas></div>
        </div>
      </div>

    </div>
  </div>
  <script>
    const $ = id => document.getElementById(id);
    const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

    // ‚îÄ‚îÄ Chart Helpers ‚îÄ‚îÄ
    function getCtx(id) { const c = $(id); const dpr = window.devicePixelRatio || 1; const w = c.offsetWidth || c.width || 300; const h = c.offsetHeight || c.height || 150; c.width = w * dpr; c.height = h * dpr; const ctx = c.getContext('2d'); ctx.scale(dpr, dpr); ctx.W = w; ctx.H = h; return ctx }
    function roundRect(ctx, x, y, w, h, r) { ctx.beginPath(); ctx.moveTo(x + r, y); ctx.lineTo(x + w - r, y); ctx.quadraticCurveTo(x + w, y, x + w, y + r); ctx.lineTo(x + w, y + h - r); ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h); ctx.lineTo(x + r, y + h); ctx.quadraticCurveTo(x, y + h, x, y + h - r); ctx.lineTo(x, y + r); ctx.quadraticCurveTo(x, y, x + r, y); ctx.closePath() }
    function drawBarChart(ctx, labels, obs, exp, colors) {
      const W = ctx.W, H = ctx.H, pad = { top: 20, right: 20, bottom: 40, left: 50 }; const plotW = W - pad.left - pad.right, plotH = H - pad.top - pad.bottom; const n = labels.length, barW = plotW / n * .35, gap = plotW / n; ctx.clearRect(0, 0, W, H); ctx.fillStyle = '#f8fafc'; roundRect(ctx, 0, 0, W, H, 6); ctx.fill(); const mv = Math.max(...obs, ...exp) * 1.3 || 10; ctx.strokeStyle = '#e5e7eb'; ctx.lineWidth = 1; for (let i = 0; i <= 4; i++) { const y = pad.top + plotH * (1 - i / 4); ctx.beginPath(); ctx.moveTo(pad.left, y); ctx.lineTo(W - pad.right, y); ctx.stroke(); ctx.fillStyle = '#9ca3af'; ctx.font = '11px system-ui'; ctx.textAlign = 'right'; ctx.fillText((mv * i / 4).toFixed(1), pad.left - 6, y + 4) }
      obs.forEach((v, i) => { const x = pad.left + gap * i + gap * .1; const h = (v / mv) * plotH; ctx.fillStyle = colors[i] || '#c41e3a'; roundRect(ctx, x, pad.top + plotH - h, barW, h, 3); ctx.fill(); const ex = x + barW + 4; const eh = (exp[i] / mv) * plotH; ctx.fillStyle = 'rgba(37,99,235,.3)'; roundRect(ctx, ex, pad.top + plotH - eh, barW, eh, 3); ctx.fill(); ctx.strokeStyle = '#2563eb'; ctx.lineWidth = 2; ctx.stroke(); ctx.fillStyle = '#374151'; ctx.font = 'bold 11px system-ui'; ctx.textAlign = 'center'; ctx.fillText(labels[i], x + barW + 2, H - pad.bottom + 16); if (v > 0) { ctx.fillStyle = '#1a1a1a'; ctx.fillText(v.toFixed(0), x + barW / 2, pad.top + plotH - h - 6) } })
    }

    // ‚îÄ‚îÄ PART 1: FLASHCARDS & QUIZ ‚îÄ‚îÄ
    const TERMS = [{ t: 'Gene', d: 'A segment of DNA that codes for a specific trait' }, { t: 'Allele', d: 'A version of a gene (e.g., brown-eye allele vs. blue-eye allele)' }, { t: 'Diploid', d: 'Having two copies of each chromosome ‚Äî one from each parent' }, { t: 'Genotype', d: 'The alleles an organism carries, written with letters (e.g., Aa)' }, { t: 'Phenotype', d: 'The physical trait you can observe (e.g., "brown eyes")' }, { t: 'Homozygous', d: 'Two identical alleles (AA or aa)' }, { t: 'Heterozygous', d: 'Two different alleles (Aa) ‚Äî also called a carrier' }, { t: 'Dominant', d: 'Allele expressed when at least one copy is present (capital letter)' }, { t: 'Recessive', d: 'Allele expressed only when two copies are present (lowercase)' }, { t: 'Punnett Square', d: 'A grid used to predict the offspring of a genetic cross' }];
    const QUIZ = [{ q: 'If someone has genotype Bb, are they homozygous or heterozygous?', a: 'heterozygous' }, { q: 'An organism with genotype aa shows the recessive trait. What genotype(s) show the dominant trait?', a: 'AA or Aa' }, { q: 'A person with genotype Aa is called a ___ for a recessive condition.', a: 'carrier' }, { q: 'Humans are ___, meaning they carry two copies of each gene.', a: 'diploid' }];

    function initFlashcards() { const el = $('flashcards'); TERMS.forEach((t, i) => { const d = document.createElement('div'); d.style.cssText = 'background:#f8fafc;border:2px solid var(--border);border-radius:10px;padding:16px;cursor:pointer;transition:all .3s;min-height:90px;display:flex;align-items:center;justify-content:center;text-align:center;'; d.innerHTML = `<div><div style="font-weight:800;font-size:16px;color:var(--accent);">${t.t}</div><div class="fc-def" style="display:none;font-size:13px;color:var(--text-muted);margin-top:6px;">${t.d}</div></div>`; d.onclick = () => { const def = d.querySelector('.fc-def'); def.style.display = def.style.display === 'none' ? 'block' : 'none'; d.style.borderColor = def.style.display === 'block' ? 'var(--accent)' : 'var(--border)'; d.style.background = def.style.display === 'block' ? '#fff' : '#f8fafc' }; el.appendChild(d) }) }

    function initQuiz() { const el = $('quiz-area'); el.innerHTML = QUIZ.map((q, i) => `<div style="margin-bottom:12px;padding:12px;background:#f8fafc;border-radius:8px;border:1px solid var(--border);"><div style="font-weight:600;font-size:14px;margin-bottom:6px;">${i + 1}. ${q.q}</div><input type="text" id="quiz-${i}" style="width:100%;padding:8px 12px;border:2px solid var(--border);border-radius:6px;font-size:14px;font-family:var(--font);" placeholder="Your answer..."></div>`).join('') }
    function checkQuiz() { let score = 0; QUIZ.forEach((q, i) => { const input = $(`quiz-${i}`); const v = input.value.trim().toLowerCase(); const correct = q.a.toLowerCase().split(' or ').some(a => v.includes(a.trim())); input.style.borderColor = correct ? 'var(--green)' : 'var(--accent)'; if (correct) score++ }); $('quiz-result').innerHTML = `<div class="analysis-result" style="border-left-color:${score === QUIZ.length ? 'var(--green)' : 'var(--amber)'}"><strong>${score}/${QUIZ.length} correct!</strong> ${score === QUIZ.length ? 'üéâ Perfect score!' : 'Keep studying the terminology table above.'}</div>` }
    function resetQuiz() { QUIZ.forEach((_, i) => { const input = $(`quiz-${i}`); input.value = ''; input.style.borderColor = 'var(--border)' }); $('quiz-result').innerHTML = '' }

    // ‚îÄ‚îÄ PART 2: COIN TOSS ‚îÄ‚îÄ
    let coinData = { AA: 0, Aa: 0, aa: 0, history: [] };
    function coinFlip(n) { for (let i = 0; i < n; i++) { const f = Math.random() < .5 ? 'A' : 'a'; const m = Math.random() < .5 ? 'A' : 'a'; const g = [f, m].sort().join(''); const key = g === 'AA' ? 'AA' : g === 'Aa' || g === 'aA' ? 'Aa' : 'aa'; coinData[key]++; const total = coinData.AA + coinData.Aa + coinData.aa; coinData.history.push(coinData.Aa / total) } coinUpdateUI() }
    function coinReset() { coinData = { AA: 0, Aa: 0, aa: 0, history: [] }; coinUpdateUI() }
    function coinUpdateUI() {
      const t = coinData.AA + coinData.Aa + coinData.aa; $('coin-aa').textContent = coinData.AA; $('coin-Aa').textContent = coinData.Aa; $('coin-bb').textContent = coinData.aa; $('coin-total').textContent = t;
      const ctx = getCtx('coin-bar'); if (t > 0) { drawBarChart(ctx, ['AA', 'Aa', 'aa'], [coinData.AA, coinData.Aa, coinData.aa], [t * .25, t * .5, t * .25], ['#c41e3a', '#d97706', '#2563eb']) } else { ctx.clearRect(0, 0, ctx.W, ctx.H); ctx.fillStyle = '#f8fafc'; roundRect(ctx, 0, 0, ctx.W, ctx.H, 6); ctx.fill(); ctx.fillStyle = '#9ca3af'; ctx.font = '14px system-ui'; ctx.textAlign = 'center'; ctx.fillText('Click "Flip" to start', ctx.W / 2, ctx.H / 2) }
      // convergence
      const ctx2 = getCtx('coin-line'); ctx2.clearRect(0, 0, ctx2.W, ctx2.H); ctx2.fillStyle = '#f8fafc'; roundRect(ctx2, 0, 0, ctx2.W, ctx2.H, 6); ctx2.fill(); if (coinData.history.length > 1) {
        const W = ctx2.W, H = ctx2.H, pad = { top: 20, right: 20, bottom: 30, left: 50 }, plotW = W - pad.left - pad.right, plotH = H - pad.top - pad.bottom; ctx2.strokeStyle = '#e5e7eb'; ctx2.lineWidth = 1; for (let i = 0; i <= 4; i++) { const y = pad.top + plotH * (1 - i / 4); ctx2.beginPath(); ctx2.moveTo(pad.left, y); ctx2.lineTo(W - pad.right, y); ctx2.stroke(); ctx2.fillStyle = '#9ca3af'; ctx2.font = '11px system-ui'; ctx2.textAlign = 'right'; ctx2.fillText((i * 25) + '%', pad.left - 6, y + 4) }
        ctx2.strokeStyle = '#9ca3af'; ctx2.lineWidth = 1; ctx2.setLineDash([6, 4]); const refY = pad.top + plotH * .5; ctx2.beginPath(); ctx2.moveTo(pad.left, refY); ctx2.lineTo(W - pad.right, refY); ctx2.stroke(); ctx2.setLineDash([]); ctx2.fillStyle = '#9ca3af'; ctx2.font = '10px system-ui'; ctx2.textAlign = 'left'; ctx2.fillText('Expected 50%', pad.left + 4, refY - 6);
        ctx2.strokeStyle = 'var(--amber)'; ctx2.lineWidth = 2; ctx2.beginPath(); const d = coinData.history; d.forEach((v, i) => { const x = pad.left + (i / (d.length - 1)) * plotW; const y = pad.top + plotH * (1 - v); i === 0 ? ctx2.moveTo(x, y) : ctx2.lineTo(x, y) }); ctx2.stroke()
      }
      // analysis
      if (t >= 20) { const chi = ((coinData.AA - t * .25) ** 2) / (t * .25) + ((coinData.Aa - t * .5) ** 2) / (t * .5) + ((coinData.aa - t * .25) ** 2) / (t * .25); const pass = chi < 5.99; $('coin-analysis').innerHTML = `<div class="analysis-result" style="border-left-color:${pass ? 'var(--green)' : 'var(--amber)'}"><strong>Chi-Square: ${chi.toFixed(2)}</strong> (critical value = 5.99 at p=0.05). ${pass ? '‚úÖ Results are consistent with expected 1:2:1 ratio.' : '‚ö†Ô∏è Results differ significantly from expected. Try more flips!'}</div>` } else { $('coin-analysis').innerHTML = '' }
    }

    // ‚îÄ‚îÄ PART 3: ALBINISM ‚îÄ‚îÄ
    let albSim = { AA: 0, Aa: 0, aa: 0 };
    function albUpdate() {
      const p1 = $('alb-p1').value, p2 = $('alb-p2').value; const a1 = p1.split(''), a2 = p2.split(''); const grid = []; for (let i = 0; i < 2; i++)for (let j = 0; j < 2; j++) { const g = [a1[i], a2[j]].sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase())); const gt = g[0] === g[1] ? (g[0] === 'A' ? 'AA' : 'aa') : 'Aa'; grid.push(gt) }
      let html = '<div class="punnett-grid"><div class="pg-cell pg-corner"></div>'; html += `<div class="pg-cell pg-header">${a2[0]}</div><div class="pg-cell pg-header">${a2[1]}</div>`; for (let i = 0; i < 2; i++) { html += `<div class="pg-cell pg-header">${a1[i]}</div>`; for (let j = 0; j < 2; j++) { const gt = grid[i * 2 + j]; html += `<div class="pg-cell pg-${gt}">${gt}</div>` } } html += '</div>'; $('alb-dynamic-grid').innerHTML = html;
      const counts = { AA: 0, Aa: 0, aa: 0 }; grid.forEach(g => counts[g]++); const total = 4; $('alb-dynamic-stats').innerHTML = `<div class="stat-grid"><div class="stat-box stat-accent"><div class="stat-val">${(counts.AA / total * 100).toFixed(0)}%</div><div class="stat-label">AA</div></div><div class="stat-box stat-amber"><div class="stat-val">${(counts.Aa / total * 100).toFixed(0)}%</div><div class="stat-label">Aa</div></div><div class="stat-box stat-blue"><div class="stat-val">${(counts.aa / total * 100).toFixed(0)}%</div><div class="stat-label">aa</div></div></div>`
    }
    function albSimulate(n) { const p1 = $('alb-p1').value, p2 = $('alb-p2').value; const a1 = p1.split(''), a2 = p2.split(''); for (let i = 0; i < n; i++) { const g = [a1[rand(0, 1)], a2[rand(0, 1)]].sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase())); const gt = g[0] === g[1] ? (g[0] === 'A' ? 'AA' : 'aa') : 'Aa'; albSim[gt]++ } const t = albSim.AA + albSim.Aa + albSim.aa; const ctx = getCtx('alb-sim-chart'); drawBarChart(ctx, ['AA', 'Aa', 'aa'], [albSim.AA, albSim.Aa, albSim.aa], [t * .25, t * .5, t * .25], ['#c41e3a', '#d97706', '#2563eb']) }
    function albResetSim() { albSim = { AA: 0, Aa: 0, aa: 0 }; const ctx = getCtx('alb-sim-chart'); ctx.clearRect(0, 0, ctx.W, ctx.H) }

    // ‚îÄ‚îÄ PART 4: COLOR BLINDNESS ‚îÄ‚îÄ
    let cbSim = {};
    function cbUpdate() {
      const mom = $('cb-mom').value, dad = $('cb-dad').value; const mAlleles = mom === 'XCXC' ? ['XC', 'XC'] : mom === 'XCXc' ? ['XC', 'Xc'] : ['Xc', 'Xc']; const dAlleles = dad === 'XCY' ? ['XC', 'Y'] : ['Xc', 'Y']; const grid = []; for (let i = 0; i < 2; i++)for (let j = 0; j < 2; j++) { grid.push({ m: mAlleles[i], d: dAlleles[j] }) }
      let html = '<div class="punnett-grid"><div class="pg-cell pg-corner"></div>'; dAlleles.forEach(a => { html += `<div class="pg-cell pg-header">${a === 'Y' ? 'Y' : a.replace('X', 'X<sup>').replace('C', 'C</sup>').replace('c', 'c</sup>')}</div>` });
      const colors = { normal: '#f0fdf4', carrier: '#fffbeb', affected: '#fef2f2' };
      mAlleles.forEach((ma, i) => {
        html += `<div class="pg-cell pg-header">${ma.replace('X', 'X<sup>').replace('C', 'C</sup>').replace('c', 'c</sup>')}</div>`; dAlleles.forEach((da, j) => {
          const child = grid[i * 2 + j]; const gt = child.m + child.d; let label, bg, textColor = '#1a1a1a'; if (da === 'Y') { if (child.m === 'XC') { label = 'X<sup>C</sup>Y'; bg = colors.normal } else { label = 'X<sup>c</sup>Y'; bg = colors.affected; textColor = 'var(--accent)' } } else { const alleles = [child.m, child.d].sort(); if (alleles[0] === 'XC' && alleles[1] === 'XC') { label = 'X<sup>C</sup>X<sup>C</sup>'; bg = colors.normal } else if (alleles.includes('XC') && alleles.includes('Xc')) { label = 'X<sup>C</sup>X<sup>c</sup>'; bg = colors.carrier } else { label = 'X<sup>c</sup>X<sup>c</sup>'; bg = colors.affected; textColor = 'var(--accent)' } }
          html += `<div class="pg-cell" style="background:${bg};color:${textColor};border:2px solid ${bg === '#fef2f2' ? '#fca5a5' : bg === '#fffbeb' ? '#fcd34d' : '#86efac'};font-size:16px;">${label}</div>`
        })
      });
      html += '</div>'; $('cb-punnett').innerHTML = html;
      // Stats
      let daughters = { normal: 0, carrier: 0, affected: 0 }, sons = { normal: 0, affected: 0 }; grid.forEach(g => { if (g.d === 'Y') { if (g.m === 'XC') sons.normal++; else sons.affected++ } else { const a = [g.m, g.d].sort(); if (a[0] === 'XC' && a[1] === 'XC') daughters.normal++; else if (a.includes('Xc') && a.includes('XC')) daughters.carrier++; else daughters.affected++ } });
      $('cb-stats').innerHTML = `<div class="stat-grid"><div class="stat-box stat-green"><div class="stat-val">${sons.normal}/2</div><div class="stat-label">Normal Sons</div></div><div class="stat-box stat-accent"><div class="stat-val">${sons.affected}/2</div><div class="stat-label">Color-blind Sons</div></div><div class="stat-box stat-green"><div class="stat-val">${daughters.normal}/2</div><div class="stat-label">Normal Daughters</div></div><div class="stat-box stat-amber"><div class="stat-val">${daughters.carrier}/2</div><div class="stat-label">Carrier Daughters</div></div></div>`
    }
    function cbSimulate(n) {
      const mom = $('cb-mom').value, dad = $('cb-dad').value; const mA = mom === 'XCXC' ? ['XC', 'XC'] : mom === 'XCXc' ? ['XC', 'Xc'] : ['Xc', 'Xc']; const dA = dad === 'XCY' ? ['XC', 'Y'] : ['Xc', 'Y']; cbSim = { normalSon: 0, affectedSon: 0, normalDau: 0, carrierDau: 0, affectedDau: 0 }; for (let i = 0; i < n; i++) { const m = mA[rand(0, 1)], d = dA[rand(0, 1)]; if (d === 'Y') { if (m === 'XC') cbSim.normalSon++; else cbSim.affectedSon++ } else { if (m === 'XC' && d === 'XC') cbSim.normalDau++; else if ((m === 'XC' && d === 'Xc') || (m === 'Xc' && d === 'XC')) cbSim.carrierDau++; else cbSim.affectedDau++ } }
      const ctx = getCtx('cb-sim-chart'); const labels = ['Normal ‚ôÇ', 'CB ‚ôÇ', 'Normal ‚ôÄ', 'Carrier ‚ôÄ', 'CB ‚ôÄ']; const vals = [cbSim.normalSon, cbSim.affectedSon, cbSim.normalDau, cbSim.carrierDau, cbSim.affectedDau]; const exp = [n * .25, n * .25, n * .25, n * .25, 0]; const cols = ['#16a34a', '#c41e3a', '#16a34a', '#d97706', '#c41e3a']; drawBarChart(ctx, labels, vals, exp, cols)
    }
    function cbResetSim() { cbSim = {}; const ctx = getCtx('cb-sim-chart'); ctx.clearRect(0, 0, ctx.W, ctx.H) }

    // ‚îÄ‚îÄ PART 5: PEDIGREE ‚îÄ‚îÄ
    const PED_FAMILY = [
      { id: 'frank', name: 'Frank', sex: 'M', gen: 0, affected: false, x: 200, y: 50 },
      { id: 'gina', name: 'Gina', sex: 'F', gen: 0, affected: false, x: 340, y: 50 },
      { id: 'maria', name: 'Maria', sex: 'F', gen: 1, affected: false, x: 80, y: 170 },
      { id: 'tom', name: 'Tom', sex: 'M', gen: 1, affected: false, x: 200, y: 170 },
      { id: 'carlos', name: 'Carlos', sex: 'M', gen: 1, affected: true, x: 340, y: 170 },
      { id: 'anna', name: 'Anna', sex: 'F', gen: 1, affected: false, x: 460, y: 170 },
      { id: 'lily', name: 'Lily', sex: 'F', gen: 2, affected: false, x: 100, y: 290 },
      { id: 'sam', name: 'Sam', sex: 'M', gen: 2, affected: false, x: 200, y: 290 }
    ];
    let pedPeople = [], pedShowGenotypes = false;
    function pedInit() { pedPeople = JSON.parse(JSON.stringify(PED_FAMILY)); pedShowGenotypes = false; pedDraw() }
    function pedReset() { pedInit() }
    function pedRevealGenotypes() { pedShowGenotypes = !pedShowGenotypes; pedDraw() }

    function pedDraw() {
      const c = $('ped-canvas'); const dpr = window.devicePixelRatio || 1; const w = c.offsetWidth || 560; const h = 360; c.style.height = h + 'px'; c.width = w * dpr; c.height = h * dpr; const ctx = c.getContext('2d'); ctx.scale(dpr, dpr);
      const sx = w / 560, sy = h / 360; function px(x) { return x * sx } function py(y) { return y * sy }
      ctx.clearRect(0, 0, w, h); ctx.fillStyle = '#f8fafc'; roundRect(ctx, 0, 0, w, h, 8); ctx.fill();
      // Scale people positions
      const positions = [{ id: 'frank', x: 200, y: 60 }, { id: 'gina', x: 340, y: 60 }, { id: 'maria', x: 100, y: 170 }, { id: 'tom', x: 200, y: 170 }, { id: 'carlos', x: 340, y: 170 }, { id: 'anna', x: 440, y: 170 }, { id: 'lily', x: 120, y: 280 }, { id: 'sam', x: 200, y: 280 }];
      positions.forEach(pos => { const p = pedPeople.find(pp => pp.id === pos.id); if (p) { p.dx = px(pos.x); p.dy = py(pos.y) } });
      ctx.strokeStyle = '#94a3b8'; ctx.lineWidth = 2;
      // Frank-Gina couple
      ctx.beginPath(); ctx.moveTo(px(228), py(60)); ctx.lineTo(px(312), py(60)); ctx.stroke();
      // Down from couple
      ctx.beginPath(); ctx.moveTo(px(270), py(60)); ctx.lineTo(px(270), py(120)); ctx.stroke();
      // Horizontal to children
      ctx.beginPath(); ctx.moveTo(px(100), py(120)); ctx.lineTo(px(440), py(120)); ctx.stroke();
      // Down to each child
      [100, 200, 340, 440].forEach(x => { ctx.beginPath(); ctx.moveTo(px(x), py(120)); ctx.lineTo(px(x), py(145)); ctx.stroke() });
      // Maria-Tom couple
      ctx.beginPath(); ctx.moveTo(px(128), py(170)); ctx.lineTo(px(172), py(170)); ctx.stroke();
      // Down from Maria-Tom
      ctx.beginPath(); ctx.moveTo(px(150), py(170)); ctx.lineTo(px(150), py(230)); ctx.stroke();
      ctx.beginPath(); ctx.moveTo(px(120), py(230)); ctx.lineTo(px(200), py(230)); ctx.stroke();
      [120, 200].forEach(x => { ctx.beginPath(); ctx.moveTo(px(x), py(230)); ctx.lineTo(px(x), py(255)); ctx.stroke() });
      // People
      const sz = Math.min(24 * sx, 24);
      pedPeople.forEach(p => {
        if (!p.dx) return; const x = p.dx, y = p.dy; if (p.sex === 'M') { ctx.fillStyle = p.affected ? '#1a1a2e' : '#fff'; ctx.strokeStyle = '#1a1a2e'; ctx.lineWidth = 3; ctx.fillRect(x - sz, y - sz, sz * 2, sz * 2); ctx.strokeRect(x - sz, y - sz, sz * 2, sz * 2) } else { ctx.fillStyle = p.affected ? '#1a1a2e' : '#fff'; ctx.strokeStyle = '#1a1a2e'; ctx.lineWidth = 3; ctx.beginPath(); ctx.arc(x, y, sz, 0, Math.PI * 2); ctx.fill(); ctx.stroke() }
        ctx.fillStyle = '#374151'; ctx.font = '12px system-ui'; ctx.textAlign = 'center'; ctx.fillText(p.name, x, y + sz + 16);
        if (pedShowGenotypes) { const gt = p.affected ? 'ff' : (p.id === 'frank' || p.id === 'gina') ? 'Ff' : 'F?'; ctx.fillStyle = p.affected ? '#fff' : '#d97706'; ctx.font = 'bold 12px system-ui'; ctx.fillText(gt, x, y + 4) }
      });
      // Legend
      ctx.fillStyle = '#6b7280'; ctx.font = '11px system-ui'; ctx.textAlign = 'left'; ctx.fillText('‚ñ°/‚óã = Unaffected', w - 160, h - 40); ctx.fillText('‚ñ†/‚óè = Affected (CF)', w - 160, h - 22);
      let html = '<div class="analysis-result" style="border-left-color:#16a34a"><strong>Pedigree Analysis:</strong><br>'; html += '‚Ä¢ Carlos is affected ‚Üí genotype <strong>ff</strong><br>'; html += '‚Ä¢ Both parents are unaffected but have an affected child ‚Üí both must be <strong>carriers (Ff)</strong><br>'; html += '‚Ä¢ Maria, Anna, Lily, Sam could be FF or Ff ‚Äî need genetic testing to know for certain'; html += '</div>'; $('ped-analysis').innerHTML = html
    }

    $('ped-canvas').addEventListener('click', function (e) { const rect = this.getBoundingClientRect(); const x = e.clientX - rect.left; const y = e.clientY - rect.top; pedPeople.forEach(p => { if (p.dx && Math.abs(x - p.dx) < 30 && Math.abs(y - p.dy) < 30) { p.affected = !p.affected; pedDraw() } }) });

    // ‚îÄ‚îÄ PART 5: CF SIMULATOR ‚îÄ‚îÄ
    let cfData = { FF: 0, Ff: 0, ff: 0 };
    function cfSimulate(n) { for (let i = 0; i < n; i++) { const a1 = Math.random() < .5 ? 'F' : 'f'; const a2 = Math.random() < .5 ? 'F' : 'f'; const g = [a1, a2].sort().join(''); if (g === 'FF') cfData.FF++; else if (g === 'Ff' || g === 'fF') cfData.Ff++; else cfData.ff++ } cfUpdateUI() }
    function cfReset() { cfData = { FF: 0, Ff: 0, ff: 0 }; cfUpdateUI() }
    function cfUpdateUI() { $('cf-FF').textContent = cfData.FF; $('cf-Ff').textContent = cfData.Ff; $('cf-ff').textContent = cfData.ff; const t = cfData.FF + cfData.Ff + cfData.ff; if (t > 0) { const ctx = getCtx('cf-chart'); drawBarChart(ctx, ['FF', 'Ff', 'ff'], [cfData.FF, cfData.Ff, cfData.ff], [t * .25, t * .5, t * .25], ['#16a34a', '#d97706', '#c41e3a']) } }

    // ‚îÄ‚îÄ SIDEBAR SCROLL ‚îÄ‚îÄ
    const navLinks = document.querySelectorAll('.sidebar-nav a'); const observer = new IntersectionObserver(entries => { entries.forEach(e => { if (e.isIntersecting) { navLinks.forEach(l => l.classList.remove('active')); const id = e.target.id; const link = document.querySelector(`.sidebar-nav a[href="#${id}"]`); if (link) link.classList.add('active') } }) }, { threshold: 0.3, rootMargin: '-80px 0px' });
    document.querySelectorAll('.section,.hero').forEach(s => observer.observe(s));

    // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
    window.addEventListener('DOMContentLoaded', () => { initFlashcards(); initQuiz(); coinUpdateUI(); albUpdate(); cbUpdate(); pedInit(); cfUpdateUI() });
  </script>
</body>

</html>