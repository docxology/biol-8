<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 4 Dashboard: Introduction to Microscopy | BIOL-8</title>
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #f0f2f5;
            --card: #ffffff;
            --sidebar: #1a1a2e;
            --sidebar-hover: #252545;
            --accent: #c41e3a;
            --accent-light: #e8354f;
            --blue: #2563eb;
            --blue-light: #3b82f6;
            --green: #16a34a;
            --amber: #d97706;
            --purple: #7c3aed;
            --text: #1a1a1a;
            --text-muted: #6b7280;
            --border: #e5e7eb;
            --radius: 10px;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
            --mono: 'SF Mono', 'Cascadia Code', 'Consolas', monospace;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font);
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .layout {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 260px;
            background: var(--sidebar);
            color: #e2e8f0;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 24px 20px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header h1 {
            font-size: 15px;
            font-weight: 700;
            color: #fff;
            letter-spacing: 0.5px;
        }

        .sidebar-header p {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
        }

        .sidebar-nav {
            flex: 1;
            padding: 12px 0;
        }

        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            color: #94a3b8;
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.15s;
            border-left: 3px solid transparent;
        }

        .sidebar-nav a:hover {
            background: var(--sidebar-hover);
            color: #e2e8f0;
        }

        .sidebar-nav a.active {
            color: #fff;
            background: var(--sidebar-hover);
            border-left-color: var(--accent);
        }

        .sidebar-nav .nav-num {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            background: rgba(255, 255, 255, 0.08);
            flex-shrink: 0;
        }

        .sidebar-nav a.active .nav-num {
            background: var(--accent);
            color: #fff;
        }

        .sidebar-footer {
            padding: 16px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 11px;
            color: #64748b;
        }

        .main {
            margin-left: 260px;
            flex: 1;
            padding: 32px;
            max-width: 1200px;
        }

        .section {
            margin-bottom: 40px;
            scroll-margin-top: 24px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .section-num {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: var(--accent);
            color: #fff;
            font-weight: 800;
            font-size: 16px;
            flex-shrink: 0;
        }

        .section-title {
            font-size: 22px;
            font-weight: 700;
        }

        .section-subtitle {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .card {
            background: var(--card);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 24px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
        }

        .card-title {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        @media (max-width: 900px) {
            .card-row {
                grid-template-columns: 1fr;
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.15s;
            font-family: var(--font);
        }

        .btn-primary {
            background: var(--accent);
            color: #fff;
        }

        .btn-primary:hover {
            background: var(--accent-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--blue);
            color: #fff;
        }

        .btn-secondary:hover {
            background: var(--blue-light);
        }

        .btn-outline {
            background: transparent;
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-outline:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .btn-sm {
            padding: 6px 14px;
            font-size: 12px;
        }

        .btn-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 12px 0;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 0;
        }

        .slider-group label {
            font-size: 13px;
            font-weight: 600;
            min-width: 100px;
        }

        .slider-group input[type=range] {
            flex: 1;
            accent-color: var(--accent);
        }

        .slider-val {
            font-family: var(--mono);
            font-size: 14px;
            font-weight: 700;
            min-width: 60px;
            text-align: right;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin: 12px 0;
        }

        .stat-box {
            text-align: center;
            padding: 14px 8px;
            border-radius: 8px;
            background: #f8fafc;
            border: 1px solid var(--border);
        }

        .stat-box .stat-val {
            font-size: 28px;
            font-weight: 800;
            font-family: var(--mono);
        }

        .stat-box .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 2px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-accent .stat-val {
            color: var(--accent);
        }

        .stat-blue .stat-val {
            color: var(--blue);
        }

        .stat-green .stat-val {
            color: var(--green);
        }

        .stat-amber .stat-val {
            color: var(--amber);
        }

        .stat-purple .stat-val {
            color: var(--purple);
        }

        .analysis-result {
            background: #f8fafc;
            border-radius: 8px;
            padding: 16px;
            margin: 10px 0;
            border-left: 4px solid var(--blue);
            font-size: 14px;
        }

        .analysis-result .ar-title {
            font-weight: 700;
            margin-bottom: 6px;
        }

        .analysis-result.ar-info {
            border-left-color: var(--blue);
        }

        .hero {
            background: linear-gradient(135deg, #1a1a2e 0%, #2d1b3d 50%, #3b1a2e 100%);
            color: #fff;
            border-radius: var(--radius);
            padding: 36px;
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
        }

        .hero::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, rgba(196, 30, 58, 0.15) 0%, transparent 70%);
            pointer-events: none;
        }

        .hero h2 {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .hero p {
            font-size: 15px;
            color: #cbd5e1;
            max-width: 600px;
            line-height: 1.7;
        }

        .hero .bio-tags {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .hero .bio-tag {
            padding: 4px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .microscope-view {
            width: 100%;
            aspect-ratio: 1;
            max-width: 400px;
            margin: 0 auto;
            border-radius: 50%;
            background: #000;
            position: relative;
            overflow: hidden;
            border: 6px solid #374151;
            box-shadow: inset 0 0 30px rgba(0, 0, 0, 0.5);
        }

        .microscope-canvas {
            width: 100%;
            height: 100%;
        }

        .part-card {
            background: #f8fafc;
            border-radius: 8px;
            padding: 12px 16px;
            border: 1px solid var(--border);
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.15s;
        }

        .part-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow);
        }

        .part-card.selected {
            border-color: var(--accent);
            background: #fef2f2;
        }

        .part-card .pc-name {
            font-weight: 700;
            font-size: 14px;
        }

        .part-card .pc-desc {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .cell-diagram {
            width: 100%;
            max-width: 500px;
            margin: 16px auto;
        }

        .quiz-option {
            display: block;
            padding: 12px 16px;
            margin: 8px 0;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.15s;
            font-size: 14px;
        }

        .quiz-option:hover {
            border-color: var(--blue);
            background: #eff6ff;
        }

        .quiz-option.correct {
            border-color: var(--green);
            background: #f0fdf4;
        }

        .quiz-option.incorrect {
            border-color: var(--accent);
            background: #fef2f2;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            margin: 12px 0;
        }

        .data-table th,
        .data-table td {
            padding: 10px 12px;
            text-align: left;
            border: 1px solid var(--border);
        }

        .data-table th {
            background: #1a1a1a;
            color: #fff;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .data-table td {
            background: #fafafa;
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main {
                margin-left: 0;
                padding: 16px;
            }
        }
    </style>
</head>

<body>
    <div class="layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>BIOL-8: Human Biology</h1>
                <p>Lab 4 &mdash; Introduction to Microscopy</p>
            </div>
            <nav class="sidebar-nav">
                <a href="#hero" class="active"><span class="nav-num">&bull;</span> Overview</a>
                <a href="#part1"><span class="nav-num">1</span> Microscope Parts</a>
                <a href="#part2"><span class="nav-num">2</span> Focusing Technique</a>
                <a href="#part3"><span class="nav-num">3</span> Letter "e" Slide</a>
                <a href="#part4"><span class="nav-num">4</span> Prepared Slides</a>
                <a href="#part5"><span class="nav-num">5</span> Cell Observations</a>
            </nav>
            <div class="sidebar-footer">Interactive Lab Dashboard<br>&copy; 2026 BIOL-8</div>
        </aside>
        <div class="main">
            <div class="hero" id="hero">
                <h2>Introduction to Microscopy</h2>
                <p>Learn proper microscope technique, identify microscope components, and observe various specimens at
                    different magnifications. Practice focusing and calculating total magnification.</p>
                <div class="bio-tags">
                    <span class="bio-tag">Light Microscopy</span>
                    <span class="bio-tag">Magnification</span>
                    <span class="bio-tag">Cell Structure</span>
                </div>
            </div>

            <!-- PART 1: MICROSCOPE PARTS -->
            <div class="section" id="part1">
                <div class="section-header">
                    <div class="section-num">1</div>
                    <div>
                        <div class="section-title">Microscope Components</div>
                        <div class="section-subtitle">Identify and learn the function of each part</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-row">
                        <div>
                            <div class="card-title">Click Each Part to Learn Its Function</div>
                            <div class="part-card" onclick="selectPart('eyepiece')">
                                <div class="pc-name">Eyepiece (Ocular Lens)</div>
                                <div class="pc-desc">Where you look through; typically 10× magnification</div>
                            </div>
                            <div class="part-card" onclick="selectPart('objective')">
                                <div class="pc-name">Objective Lenses</div>
                                <div class="pc-desc">4×, 10×, 40× magnification options</div>
                            </div>
                            <div class="part-card" onclick="selectPart('stage')">
                                <div class="pc-name">Stage</div>
                                <div class="pc-desc">Platform where the slide is placed</div>
                            </div>
                            <div class="part-card" onclick="selectPart('coarse')">
                                <div class="pc-name">Coarse Focus Knob</div>
                                <div class="pc-desc">For initial focusing; large adjustments</div>
                            </div>
                            <div class="part-card" onclick="selectPart('fine')">
                                <div class="pc-name">Fine Focus Knob</div>
                                <div class="pc-desc">For precise focusing; small adjustments</div>
                            </div>
                            <div class="part-card" onclick="selectPart('diaphragm')">
                                <div class="pc-name">Diaphragm</div>
                                <div class="pc-desc">Controls amount of light passing through specimen</div>
                            </div>
                            <div class="part-card" onclick="selectPart('light')">
                                <div class="pc-name">Light Source</div>
                                <div class="pc-desc">Illuminates the specimen from below</div>
                            </div>
                        </div>
                        <div>
                            <div class="card-title">Part Details</div>
                            <div class="analysis-result ar-info" id="part-details">
                                <div class="ar-title">Select a Part</div>
                                <p>Click on any microscope part to learn more about its function and proper use.</p>
                            </div>
                            <div class="stat-grid">
                                <div class="stat-box stat-accent">
                                    <div class="stat-val" id="parts-learned">0</div>
                                    <div class="stat-label">Parts Learned</div>
                                </div>
                                <div class="stat-box stat-green">
                                    <div class="stat-val">7</div>
                                    <div class="stat-label">Total Parts</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PART 2: FOCUSING TECHNIQUE -->
            <div class="section" id="part2">
                <div class="section-header">
                    <div class="section-num">2</div>
                    <div>
                        <div class="section-title">Focusing Technique</div>
                        <div class="section-subtitle">Practice proper focusing procedure</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-row">
                        <div>
                            <div class="card-title">Virtual Microscope</div>
                            <div class="microscope-view">
                                <canvas id="microscope-canvas" class="microscope-canvas"></canvas>
                            </div>
                        </div>
                        <div>
                            <div class="card-title">Magnification & Focus Controls</div>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-secondary" onclick="setMag(4)">4× Low</button>
                                <button class="btn btn-sm btn-secondary" onclick="setMag(10)">10× Med</button>
                                <button class="btn btn-sm btn-secondary" onclick="setMag(40)">40× High</button>
                            </div>
                            <div class="slider-group">
                                <label>Coarse Focus</label>
                                <input type="range" id="coarse-focus" min="0" max="100" value="50"
                                    oninput="updateFocus()">
                                <span class="slider-val" id="coarse-val">50</span>
                            </div>
                            <div class="slider-group">
                                <label>Fine Focus</label>
                                <input type="range" id="fine-focus" min="0" max="100" value="50"
                                    oninput="updateFocus()">
                                <span class="slider-val" id="fine-val">50</span>
                            </div>
                            <div class="slider-group">
                                <label>Light Intensity</label>
                                <input type="range" id="light-slider" min="20" max="100" value="70"
                                    oninput="updateFocus()">
                                <span class="slider-val" id="light-val">70%</span>
                            </div>
                            <div class="stat-grid">
                                <div class="stat-box stat-accent">
                                    <div class="stat-val" id="obj-mag">4×</div>
                                    <div class="stat-label">Objective</div>
                                </div>
                                <div class="stat-box stat-blue">
                                    <div class="stat-val">10×</div>
                                    <div class="stat-label">Eyepiece</div>
                                </div>
                                <div class="stat-box stat-green">
                                    <div class="stat-val" id="total-mag">40×</div>
                                    <div class="stat-label">Total Mag</div>
                                </div>
                            </div>
                            <div class="analysis-result ar-info">
                                <div class="ar-title">Total Magnification Formula</div>
                                <p><strong>Total = Eyepiece × Objective</strong></p>
                                <p style="margin-top:4px;font-size:12px;">Example: 10× eyepiece × 40× objective = 400×
                                    total</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PART 3: LETTER E -->
            <div class="section" id="part3">
                <div class="section-header">
                    <div class="section-num">3</div>
                    <div>
                        <div class="section-title">Letter "e" Slide</div>
                        <div class="section-subtitle">Observe image orientation under the microscope</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Image Orientation Discovery</div>
                    <p style="font-size:13px;color:var(--text-muted);margin-bottom:12px;">Under a compound microscope,
                        images appear inverted (upside-down) and reversed (left-right). Practice observing this
                        phenomenon.</p>
                    <div class="card-row">
                        <div style="text-align:center;">
                            <div class="card-title">Actual Letter Position</div>
                            <div
                                style="font-size:120px;font-weight:800;font-family:serif;color:var(--text);padding:20px;">
                                e</div>
                            <p style="font-size:12px;color:var(--text-muted);">How the letter appears on the slide</p>
                        </div>
                        <div style="text-align:center;">
                            <div class="card-title">Through Microscope</div>
                            <div
                                style="font-size:120px;font-weight:800;font-family:serif;color:var(--accent);padding:20px;transform:rotate(180deg);">
                                e</div>
                            <p style="font-size:12px;color:var(--text-muted);">Inverted and reversed image</p>
                        </div>
                    </div>
                    <div class="analysis-result ar-info">
                        <div class="ar-title">Key Observation</div>
                        <p>When you move the slide to the RIGHT, the image moves to the LEFT. When you move the slide
                            DOWN, the image moves UP. This is because compound microscopes use multiple lenses that
                            invert the image.</p>
                    </div>
                </div>
            </div>

            <!-- PART 4: PREPARED SLIDES -->
            <div class="section" id="part4">
                <div class="section-header">
                    <div class="section-num">4</div>
                    <div>
                        <div class="section-title">Prepared Slides</div>
                        <div class="section-subtitle">View different specimens</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Select a Specimen</div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="loadSlide('cheek')">Cheek Cells</button>
                        <button class="btn btn-secondary" onclick="loadSlide('onion')">Onion Cells</button>
                        <button class="btn btn-secondary" onclick="loadSlide('blood')">Blood Smear</button>
                        <button class="btn btn-secondary" onclick="loadSlide('bacteria')">Bacteria</button>
                    </div>
                    <div class="microscope-view" style="max-width:350px;">
                        <canvas id="slide-canvas" class="microscope-canvas"></canvas>
                    </div>
                    <div id="slide-info" class="analysis-result ar-info">
                        <div class="ar-title">Cheek Cells</div>
                        <p>Human epithelial cells from the inside of the cheek. Note the irregular shape, visible
                            nucleus (dark spot), and cell membrane.</p>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Observation Notes</div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Specimen</th>
                                <th>Cell Shape</th>
                                <th>Nucleus Visible?</th>
                                <th>Cell Wall?</th>
                                <th>Approx. Size</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Cheek Cells</td>
                                <td>Irregular/Flat</td>
                                <td>Yes</td>
                                <td>No (membrane only)</td>
                                <td>~50-80 μm</td>
                            </tr>
                            <tr>
                                <td>Onion Cells</td>
                                <td>Rectangular</td>
                                <td>Yes</td>
                                <td>Yes</td>
                                <td>~250-400 μm</td>
                            </tr>
                            <tr>
                                <td>Red Blood Cells</td>
                                <td>Round (biconcave)</td>
                                <td>No</td>
                                <td>No</td>
                                <td>~7-8 μm</td>
                            </tr>
                            <tr>
                                <td>Bacteria</td>
                                <td>Rod/Sphere</td>
                                <td>No (no true nucleus)</td>
                                <td>Yes</td>
                                <td>~1-5 μm</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- PART 5: CELL OBSERVATIONS -->
            <div class="section" id="part5">
                <div class="section-header">
                    <div class="section-num">5</div>
                    <div>
                        <div class="section-title">Cell Structure Quiz</div>
                        <div class="section-subtitle">Test your knowledge of microscopy and cell structure</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">Quiz: Identifying Structures</div>
                    <div id="quiz-container">
                        <p id="quiz-question" style="font-size:15px;font-weight:600;margin-bottom:12px;">Q1: What is the
                            function of the diaphragm on a microscope?</p>
                        <div class="quiz-option" onclick="checkAnswer(this, 0)">A. To magnify the specimen</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 1)">B. To control the amount of light</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 2)">C. To hold the slide in place</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 3)">D. To change the objective lens</div>
                    </div>
                    <div class="btn-group" style="margin-top:16px;">
                        <button class="btn btn-secondary" onclick="nextQuestion()">Next Question</button>
                        <button class="btn btn-outline" onclick="resetQuiz()">Restart Quiz</button>
                    </div>
                    <div class="stat-grid" style="margin-top:16px;">
                        <div class="stat-box stat-green">
                            <div class="stat-val" id="quiz-correct">0</div>
                            <div class="stat-label">Correct</div>
                        </div>
                        <div class="stat-box stat-accent">
                            <div class="stat-val" id="quiz-total">0</div>
                            <div class="stat-label">Attempted</div>
                        </div>
                        <div class="stat-box stat-blue">
                            <div class="stat-val" id="quiz-pct">0%</div>
                            <div class="stat-label">Score</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        const $ = id => document.getElementById(id);
        const rand = (min, max) => Math.random() * (max - min) + min;

        // MICROSCOPE PARTS
        const partDetails = {
            eyepiece: { title: 'Eyepiece (Ocular Lens)', desc: 'The lens you look through, typically 10× magnification. It works together with the objective lens to produce total magnification.' },
            objective: { title: 'Objective Lenses', desc: 'Rotating lenses with different magnifications (4×, 10×, 40×). Always start with the lowest power and work up. Never use coarse focus with high power objectives.' },
            stage: { title: 'Stage', desc: 'The flat platform where specimens are placed. Stage clips hold the slide in position. Some microscopes have mechanical stages with X-Y controls.' },
            coarse: { title: 'Coarse Focus Knob', desc: 'Used for initial focusing with low power objectives. Makes large focus adjustments. NEVER use with 40× objective to avoid damaging the lens or slide.' },
            fine: { title: 'Fine Focus Knob', desc: 'Used for precise focusing, especially at higher magnifications. Makes small, subtle adjustments to achieve perfect focus.' },
            diaphragm: { title: 'Diaphragm', desc: 'Controls the amount of light passing through the specimen. Adjust for optimal contrast - too much light can wash out details, too little makes viewing difficult.' },
            light: { title: 'Light Source', desc: 'Illuminates the specimen from below. Modern microscopes use LED lights; older ones use mirrors to reflect external light.' }
        };
        let partsLearned = new Set();

        function selectPart(part) {
            document.querySelectorAll('.part-card').forEach(el => el.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            const info = partDetails[part];
            $('part-details').innerHTML = `<div class="ar-title">${info.title}</div><p>${info.desc}</p>`;
            partsLearned.add(part);
            $('parts-learned').textContent = partsLearned.size;
        }

        // FOCUSING
        let currentMag = 4;
        let optimalFocus = 45;

        function setMag(mag) {
            currentMag = mag;
            optimalFocus = 30 + Math.random() * 40;
            $('obj-mag').textContent = mag + '×';
            $('total-mag').textContent = (mag * 10) + '×';
            updateFocus();
        }

        function updateFocus() {
            const coarse = parseInt($('coarse-focus').value);
            const fine = parseInt($('fine-focus').value);
            const light = parseInt($('light-slider').value);
            $('coarse-val').textContent = coarse;
            $('fine-val').textContent = fine;
            $('light-val').textContent = light + '%';
            const focusVal = coarse + fine * 0.1;
            const blur = Math.abs(focusVal - optimalFocus) / 10;
            drawMicroscopeView('microscope-canvas', 'letter', blur, light);
        }

        function drawMicroscopeView(canvasId, specimen, blur, light) {
            const canvas = $(canvasId);
            const ctx = canvas.getContext('2d');
            const size = Math.min(canvas.offsetWidth, canvas.offsetHeight) || 300;
            const dpr = window.devicePixelRatio || 1;
            canvas.width = size * dpr;
            canvas.height = size * dpr;
            ctx.scale(dpr, dpr);
            const lightVal = light / 100;
            ctx.fillStyle = `rgb(${Math.floor(240 * lightVal)}, ${Math.floor(245 * lightVal)}, ${Math.floor(250 * lightVal)})`;
            ctx.fillRect(0, 0, size, size);
            ctx.save();
            ctx.filter = `blur(${Math.min(blur, 8)}px)`;
            if (specimen === 'letter') {
                ctx.fillStyle = '#1a1a1a';
                ctx.font = `bold ${size * 0.4 / (currentMag / 10)}px serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.translate(size / 2, size / 2);
                ctx.rotate(Math.PI);
                ctx.fillText('e', 0, 0);
            }
            ctx.restore();
        }

        // SLIDES
        const slideInfo = {
            cheek: { title: 'Cheek Cells', desc: 'Human epithelial cells from the inside of the cheek. Note the irregular shape, visible nucleus (dark spot), and cell membrane.' },
            onion: { title: 'Onion Cells', desc: 'Plant cells from onion epidermis. Notice the rectangular shape, cell wall, and clearly visible nucleus. The regular brick-like pattern is characteristic of plant tissues.' },
            blood: { title: 'Blood Smear', desc: 'Red blood cells appear as small, round, biconcave discs. They lack a nucleus. Occasional larger cells with purple nuclei are white blood cells.' },
            bacteria: { title: 'Bacteria', desc: 'Prokaryotic cells that are much smaller than eukaryotic cells. They lack a membrane-bound nucleus. Shapes include rods (bacilli), spheres (cocci), and spirals.' }
        };

        function loadSlide(type) {
            const info = slideInfo[type];
            $('slide-info').innerHTML = `<div class="ar-title">${info.title}</div><p>${info.desc}</p>`;
            drawSlide(type);
        }

        function drawSlide(type) {
            const canvas = $('slide-canvas');
            const ctx = canvas.getContext('2d');
            const size = Math.min(canvas.offsetWidth, canvas.offsetHeight) || 300;
            const dpr = window.devicePixelRatio || 1;
            canvas.width = size * dpr;
            canvas.height = size * dpr;
            ctx.scale(dpr, dpr);
            ctx.fillStyle = '#f0f5f0';
            ctx.fillRect(0, 0, size, size);
            if (type === 'cheek') {
                for (let i = 0; i < 8; i++) {
                    const x = rand(40, size - 40);
                    const y = rand(40, size - 40);
                    const w = rand(50, 80);
                    const h = rand(30, 50);
                    ctx.fillStyle = 'rgba(255, 220, 200, 0.7)';
                    ctx.beginPath();
                    ctx.ellipse(x, y, w, h, rand(0, Math.PI), 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = 'rgba(180, 140, 120, 0.8)';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    ctx.fillStyle = 'rgba(80, 50, 80, 0.6)';
                    ctx.beginPath();
                    ctx.arc(x + rand(-10, 10), y + rand(-5, 5), rand(8, 12), 0, Math.PI * 2);
                    ctx.fill();
                }
            } else if (type === 'onion') {
                const cellW = 60, cellH = 35;
                for (let row = 0; row < 8; row++) {
                    for (let col = 0; col < 5; col++) {
                        const x = col * cellW + 15;
                        const y = row * cellH + 10;
                        ctx.fillStyle = 'rgba(200, 255, 200, 0.5)';
                        ctx.fillRect(x, y, cellW - 2, cellH - 2);
                        ctx.strokeStyle = 'rgba(100, 150, 100, 0.8)';
                        ctx.lineWidth = 1.5;
                        ctx.strokeRect(x, y, cellW - 2, cellH - 2);
                        ctx.fillStyle = 'rgba(80, 80, 120, 0.5)';
                        ctx.beginPath();
                        ctx.arc(x + cellW / 2, y + cellH / 2, 6, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            } else if (type === 'blood') {
                for (let i = 0; i < 50; i++) {
                    const x = rand(20, size - 20);
                    const y = rand(20, size - 20);
                    ctx.fillStyle = 'rgba(220, 80, 80, 0.6)';
                    ctx.beginPath();
                    ctx.arc(x, y, rand(5, 8), 0, Math.PI * 2);
                    ctx.fill();
                    ctx.fillStyle = 'rgba(255, 180, 180, 0.4)';
                    ctx.beginPath();
                    ctx.arc(x, y, rand(2, 3), 0, Math.PI * 2);
                    ctx.fill();
                }
                ctx.fillStyle = 'rgba(100, 80, 150, 0.8)';
                ctx.beginPath();
                ctx.arc(size / 2 + 30, size / 2 - 20, 12, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = 'rgba(60, 40, 100, 0.9)';
                ctx.beginPath();
                ctx.arc(size / 2 + 30, size / 2 - 20, 6, 0, Math.PI * 2);
                ctx.fill();
            } else if (type === 'bacteria') {
                for (let i = 0; i < 40; i++) {
                    const x = rand(20, size - 20);
                    const y = rand(20, size - 20);
                    ctx.fillStyle = 'rgba(100, 100, 180, 0.7)';
                    if (Math.random() > 0.5) {
                        ctx.beginPath();
                        ctx.arc(x, y, rand(3, 5), 0, Math.PI * 2);
                        ctx.fill();
                    } else {
                        ctx.save();
                        ctx.translate(x, y);
                        ctx.rotate(rand(0, Math.PI));
                        ctx.beginPath();
                        ctx.ellipse(0, 0, rand(8, 12), rand(3, 4), 0, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.restore();
                    }
                }
            }
        }

        // QUIZ
        const questions = [
            { q: 'What is the function of the diaphragm on a microscope?', a: 1, opts: ['To magnify the specimen', 'To control the amount of light', 'To hold the slide in place', 'To change the objective lens'] },
            { q: 'If the eyepiece is 10× and the objective is 40×, what is the total magnification?', a: 2, opts: ['50×', '400×', '400×', '4000×'] },
            { q: 'Which focus knob should you use first when focusing?', a: 0, opts: ['Coarse focus', 'Fine focus', 'Either one', 'Neither'] },
            { q: 'Plant cells differ from animal cells by having:', a: 1, opts: ['A nucleus', 'A cell wall', 'Mitochondria', 'Ribosomes'] },
            { q: "Images viewed through a compound microscope appear:", a: 2, opts: ['Right-side up', 'Only reversed left-right', 'Inverted and reversed', 'The same as without a microscope'] }
        ];
        let quizIdx = 0, quizCorrect = 0, quizTotal = 0;

        function showQuestion() {
            const q = questions[quizIdx];
            $('quiz-question').textContent = `Q${quizIdx + 1}: ${q.q}`;
            const container = $('quiz-container');
            const opts = container.querySelectorAll('.quiz-option');
            opts.forEach((opt, i) => {
                opt.textContent = String.fromCharCode(65 + i) + '. ' + q.opts[i];
                opt.className = 'quiz-option';
                opt.onclick = function () { checkAnswer(this, i); };
            });
        }

        function checkAnswer(el, idx) {
            const q = questions[quizIdx];
            const correct = idx === q.a;
            el.classList.add(correct ? 'correct' : 'incorrect');
            if (correct) quizCorrect++;
            quizTotal++;
            $('quiz-correct').textContent = quizCorrect;
            $('quiz-total').textContent = quizTotal;
            $('quiz-pct').textContent = Math.round((quizCorrect / quizTotal) * 100) + '%';
            document.querySelectorAll('.quiz-option').forEach(opt => opt.onclick = null);
        }

        function nextQuestion() {
            quizIdx = (quizIdx + 1) % questions.length;
            showQuestion();
        }

        function resetQuiz() {
            quizIdx = 0;
            quizCorrect = 0;
            quizTotal = 0;
            $('quiz-correct').textContent = '0';
            $('quiz-total').textContent = '0';
            $('quiz-pct').textContent = '0%';
            showQuestion();
        }

        // INIT
        updateFocus();
        loadSlide('cheek');
        showQuestion();
    </script>
</body>

</html>