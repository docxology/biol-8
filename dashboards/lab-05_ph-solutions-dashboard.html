<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lab 5 Dashboard: Liquids Measurement | BIOL-8</title>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0
    }

    :root {
      --bg: #f0f2f5;
      --card: #fff;
      --sidebar: #1a1a2e;
      --sidebar-hover: #252545;
      --accent: #c41e3a;
      --accent-light: #e8354f;
      --blue: #2563eb;
      --blue-light: #3b82f6;
      --green: #16a34a;
      --amber: #d97706;
      --purple: #7c3aed;
      --teal: #0d9488;
      --text: #1a1a1a;
      --text-muted: #6b7280;
      --border: #e5e7eb;
      --radius: 10px;
      --shadow: 0 1px 3px rgba(0, 0, 0, .08);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1);
      --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
      --mono: 'SF Mono', 'Cascadia Code', 'Consolas', monospace
    }

    html {
      scroll-behavior: smooth
    }

    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      line-height: 1.6
    }

    .layout {
      display: flex;
      min-height: 100vh
    }

    .sidebar {
      width: 260px;
      background: var(--sidebar);
      color: #e2e8f0;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      display: flex;
      flex-direction: column
    }

    .sidebar-header {
      padding: 24px 20px 16px;
      border-bottom: 1px solid rgba(255, 255, 255, .1)
    }

    .sidebar-header h1 {
      font-size: 15px;
      font-weight: 700;
      color: #fff;
      letter-spacing: .5px
    }

    .sidebar-header p {
      font-size: 12px;
      color: #94a3b8;
      margin-top: 4px
    }

    .sidebar-nav {
      flex: 1;
      padding: 12px 0
    }

    .sidebar-nav a {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 20px;
      color: #94a3b8;
      text-decoration: none;
      font-size: 13px;
      font-weight: 500;
      transition: all .15s;
      border-left: 3px solid transparent
    }

    .sidebar-nav a:hover {
      background: var(--sidebar-hover);
      color: #e2e8f0
    }

    .sidebar-nav a.active {
      color: #fff;
      background: var(--sidebar-hover);
      border-left-color: var(--accent)
    }

    .sidebar-nav .nav-num {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 700;
      background: rgba(255, 255, 255, .08);
      flex-shrink: 0
    }

    .sidebar-nav a.active .nav-num {
      background: var(--accent);
      color: #fff
    }

    .sidebar-footer {
      padding: 16px 20px;
      border-top: 1px solid rgba(255, 255, 255, .1);
      font-size: 11px;
      color: #64748b
    }

    .main {
      margin-left: 260px;
      flex: 1;
      padding: 32px;
      max-width: 1200px
    }

    .section {
      margin-bottom: 40px;
      scroll-margin-top: 24px
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px
    }

    .section-num {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: var(--accent);
      color: #fff;
      font-weight: 800;
      font-size: 16px;
      flex-shrink: 0
    }

    .section-title {
      font-size: 22px;
      font-weight: 700
    }

    .section-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 2px
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 24px;
      margin-bottom: 16px;
      border: 1px solid var(--border)
    }

    .card-title {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px
    }

    .card-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px
    }

    .card-row-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 16px
    }

    @media(max-width:900px) {

      .card-row,
      .card-row-3 {
        grid-template-columns: 1fr
      }
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all .15s;
      font-family: var(--font)
    }

    .btn-primary {
      background: var(--accent);
      color: #fff
    }

    .btn-primary:hover {
      background: var(--accent-light);
      transform: translateY(-1px);
      box-shadow: var(--shadow-lg)
    }

    .btn-secondary {
      background: var(--blue);
      color: #fff
    }

    .btn-secondary:hover {
      background: var(--blue-light)
    }

    .btn-outline {
      background: transparent;
      color: var(--text);
      border: 2px solid var(--border)
    }

    .btn-outline:hover {
      border-color: var(--accent);
      color: var(--accent)
    }

    .btn-sm {
      padding: 6px 14px;
      font-size: 12px
    }

    .btn-group {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 12px 0
    }

    .slider-group {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 8px 0
    }

    .slider-group label {
      font-size: 13px;
      font-weight: 600;
      min-width: 80px
    }

    .slider-group input[type=range] {
      flex: 1;
      accent-color: var(--accent)
    }

    .slider-val {
      font-family: var(--mono);
      font-size: 14px;
      font-weight: 700;
      min-width: 50px;
      text-align: right
    }

    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      margin: 12px 0
    }

    .stat-box {
      text-align: center;
      padding: 14px 8px;
      border-radius: 8px;
      background: #f8fafc;
      border: 1px solid var(--border)
    }

    .stat-box .stat-val {
      font-size: 24px;
      font-weight: 800;
      font-family: var(--mono)
    }

    .stat-box .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 2px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: .5px
    }

    .stat-accent .stat-val {
      color: var(--accent)
    }

    .stat-blue .stat-val {
      color: var(--blue)
    }

    .stat-green .stat-val {
      color: var(--green)
    }

    .stat-amber .stat-val {
      color: var(--amber)
    }

    .stat-purple .stat-val {
      color: var(--purple)
    }

    .stat-teal .stat-val {
      color: var(--teal)
    }

    .chart-wrap {
      position: relative;
      width: 100%;
      margin: 8px 0
    }

    .chart-wrap canvas {
      width: 100% !important;
      display: block;
      border-radius: 6px
    }

    .analysis-result {
      background: #f8fafc;
      border-radius: 8px;
      padding: 16px;
      margin: 10px 0;
      border-left: 4px solid var(--blue);
      font-size: 14px
    }

    .analysis-result .ar-title {
      font-weight: 700;
      margin-bottom: 6px
    }

    .hero {
      background: linear-gradient(135deg, #1a1a2e 0%, #1b2d3d 50%, #1a2e2e 100%);
      color: #fff;
      border-radius: var(--radius);
      padding: 36px;
      margin-bottom: 32px;
      position: relative;
      overflow: hidden
    }

    .hero::after {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(13, 148, 136, .15) 0%, transparent 70%);
      pointer-events: none
    }

    .hero h2 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 8px
    }

    .hero p {
      font-size: 15px;
      color: #cbd5e1;
      max-width: 600px;
      line-height: 1.7
    }

    .hero .bio-tags {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap
    }

    .hero .bio-tag {
      padding: 4px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      background: rgba(255, 255, 255, .1);
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255, 255, 255, .15)
    }

    .quiz-option {
      display: block;
      width: 100%;
      text-align: left;
      padding: 12px 16px;
      margin: 6px 0;
      border-radius: 8px;
      border: 2px solid var(--border);
      background: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all .15s;
      font-family: var(--font)
    }

    .quiz-option:hover {
      border-color: var(--blue);
      background: #f0f7ff
    }

    .quiz-option.correct {
      border-color: var(--green);
      background: #f0fdf4;
      color: var(--green)
    }

    .quiz-option.wrong {
      border-color: var(--accent);
      background: #fef2f2;
      color: var(--accent)
    }

    .quiz-feedback {
      padding: 12px;
      border-radius: 8px;
      margin: 8px 0;
      font-size: 13px;
      font-weight: 600;
      display: none
    }

    .quiz-score {
      font-size: 18px;
      font-weight: 800;
      font-family: var(--mono)
    }

    .data-input {
      width: 100%;
      padding: 8px 12px;
      border: 2px solid var(--border);
      border-radius: 8px;
      font-family: var(--mono);
      font-size: 14px;
      transition: border-color .15s
    }

    .data-input:focus {
      outline: none;
      border-color: var(--blue)
    }

    table.summary-table {
      width: 100%;
      border-collapse: collapse;
      margin: 12px 0
    }

    table.summary-table th,
    table.summary-table td {
      padding: 10px 14px;
      border: 1px solid var(--border);
      text-align: left;
      font-size: 13px
    }

    table.summary-table th {
      background: #f1f5f9;
      font-weight: 700;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .5px
    }

    table.summary-table input {
      width: 100%;
      padding: 6px 8px;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-family: var(--mono);
      font-size: 13px
    }

    @media(max-width:768px) {
      .sidebar {
        display: none
      }

      .main {
        margin-left: 0;
        padding: 16px
      }
    }
  </style>
</head>

<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>BIOL-8: Human Biology</h1>
        <p>Lab 5 &mdash; Liquids Measurement</p>
      </div>
      <nav class="sidebar-nav">
        <a href="#hero" class="active"><span class="nav-num">&bull;</span> Overview</a>
        <a href="#setup"><span class="nav-num">0</span> Setup & Equipment</a>
        <a href="#ph"><span class="nav-num">1</span> pH Meter</a>
        <a href="#conductivity"><span class="nav-num">2</span> Conductivity</a>
        <a href="#temperature"><span class="nav-num">3</span> Temperature</a>
        <a href="#do"><span class="nav-num">4</span> Dissolved Oxygen</a>
        <a href="#colorimeter"><span class="nav-num">5</span> Colorimeter</a>
        <a href="#turbidity"><span class="nav-num">6</span> Turbidity</a>
        <a href="#summary"><span class="nav-num">7</span> Summary Table</a>
        <a href="#quiz"><span class="nav-num">Q</span> Knowledge Check</a>
      </nav>
      <div class="sidebar-footer">Interactive Lab Dashboard<br>&copy; 2026 BIOL-8</div>
    </aside>

    <div class="main">
      <!-- HERO -->
      <div class="hero" id="hero">
        <h2>Liquids Measurement</h2>
        <p>Use six different Vernier probes to measure and compare the physical and chemical properties of Tap Water and
          Lemon Juice. Explore interactive visualizations of each measurement type below.</p>
        <div class="bio-tags">
          <span class="bio-tag">LabQuest Mini</span>
          <span class="bio-tag">pH</span>
          <span class="bio-tag">Conductivity</span>
          <span class="bio-tag">Temperature</span>
          <span class="bio-tag">Dissolved O₂</span>
          <span class="bio-tag">Colorimetry</span>
          <span class="bio-tag">Turbidity</span>
        </div>
      </div>

      <!-- ═══ SETUP ═══ -->
      <div class="section" id="setup">
        <div class="section-header">
          <div class="section-num">0</div>
          <div>
            <div class="section-title">Setup & Equipment</div>
            <div class="section-subtitle">LabQuest Mini, Logger Pro 3.16.2, and Vernier probes</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Equipment Overview</div>
          <div class="stat-grid">
            <div class="stat-box stat-teal">
              <div class="stat-val">6</div>
              <div class="stat-label">Probes</div>
            </div>
            <div class="stat-box stat-blue">
              <div class="stat-val">2</div>
              <div class="stat-label">Liquids</div>
            </div>
            <div class="stat-box stat-accent">
              <div class="stat-val">USB</div>
              <div class="stat-label">Connection</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val">3.16</div>
              <div class="stat-label">Logger Pro</div>
            </div>
          </div>
          <div class="analysis-result">
            <div class="ar-title">Two Test Liquids</div>
            <p><strong>Pure Tap Water</strong> — Clear, near-neutral pH, low dissolved solids<br>
              <strong>Lemon Juice</strong> — Cloudy, acidic (citric acid), high dissolved solids and sugars
            </p>
          </div>
          <div class="analysis-result">
            <div class="ar-title">⚠️ Between Samples</div>
            <p>Always <strong>rinse the probe with distilled water</strong> and blot dry before switching liquids to
              avoid cross-contamination.</p>
          </div>
        </div>
      </div>

      <!-- ═══ PART 1: pH ═══ -->
      <div class="section" id="ph">
        <div class="section-header">
          <div class="section-num">1</div>
          <div>
            <div class="section-title">pH Meter</div>
            <div class="section-subtitle">Measure hydrogen ion concentration &mdash; the acidity or alkalinity of each
              liquid</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Interactive pH Scale</div>
          <div class="slider-group">
            <label>pH Value</label>
            <input type="range" id="ph-slider" min="0" max="140" value="70" oninput="phUpdate()">
            <span class="slider-val" id="ph-val">7.0</span>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-accent">
              <div class="stat-val" id="ph-class">Neutral</div>
              <div class="stat-label">Classification</div>
            </div>
            <div class="stat-box stat-blue">
              <div class="stat-val" id="ph-h">1.0e-7</div>
              <div class="stat-label">H⁺ (mol/L)</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="ph-example">Pure Water</div>
              <div class="stat-label">Example</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="ph-canvas" height="200"></canvas></div>
          <div class="btn-group">
            <button class="btn btn-primary" onclick="phPreset(20)">Lemon Juice (2.0)</button>
            <button class="btn btn-secondary" onclick="phPreset(70)">Tap Water (7.0)</button>
            <button class="btn btn-outline" onclick="phPreset(83)">Baking Soda (8.3)</button>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Expected Results</div>
          <div class="chart-wrap"><canvas id="ph-compare" height="200"></canvas></div>
        </div>
      </div>

      <!-- ═══ PART 2: CONDUCTIVITY ═══ -->
      <div class="section" id="conductivity">
        <div class="section-header">
          <div class="section-num">2</div>
          <div>
            <div class="section-title">Conductivity Probe</div>
            <div class="section-subtitle">Measure total dissolved solids &mdash; how well each liquid conducts
              electricity</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Conductivity Simulator</div>
          <div class="slider-group">
            <label>Ion Conc.</label>
            <input type="range" id="cond-slider" min="0" max="100" value="20" oninput="condUpdate()">
            <span class="slider-val" id="cond-val">200 µS</span>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-blue">
              <div class="stat-val" id="cond-tds">100</div>
              <div class="stat-label">TDS (ppm)</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="cond-quality">Good</div>
              <div class="stat-label">Water Quality</div>
            </div>
            <div class="stat-box stat-amber">
              <div class="stat-val" id="cond-current">Low</div>
              <div class="stat-label">Current Flow</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="cond-canvas" height="240"></canvas></div>
          <div class="btn-group">
            <button class="btn btn-secondary" onclick="condPreset(5)">Distilled Water</button>
            <button class="btn btn-primary" onclick="condPreset(20)">Tap Water</button>
            <button class="btn btn-primary" onclick="condPreset(60)">Lemon Juice</button>
            <button class="btn btn-outline" onclick="condPreset(95)">Seawater</button>
          </div>
        </div>
      </div>

      <!-- ═══ PART 3: TEMPERATURE ═══ -->
      <div class="section" id="temperature">
        <div class="section-header">
          <div class="section-num">3</div>
          <div>
            <div class="section-title">Temperature Probe</div>
            <div class="section-subtitle">Compare digital probe and mercury thermometer readings in °C</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Thermometer Comparison</div>
          <div class="slider-group">
            <label>Temperature</label>
            <input type="range" id="temp-slider" min="0" max="100" value="22" oninput="tempUpdate()">
            <span class="slider-val" id="temp-val">22.0°C</span>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-accent">
              <div class="stat-val" id="temp-f">71.6°F</div>
              <div class="stat-label">Fahrenheit</div>
            </div>
            <div class="stat-box stat-blue">
              <div class="stat-val" id="temp-k">295.2 K</div>
              <div class="stat-label">Kelvin</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="temp-bio">Room Temp</div>
              <div class="stat-label">Context</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="temp-canvas" height="240"></canvas></div>
        </div>
      </div>

      <!-- ═══ PART 4: DISSOLVED OXYGEN ═══ -->
      <div class="section" id="do">
        <div class="section-header">
          <div class="section-num">4</div>
          <div>
            <div class="section-title">Dissolved Oxygen Probe</div>
            <div class="section-subtitle">Measure O₂ dissolved in each liquid &mdash; critical for aquatic life</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Dissolved Oxygen Gauge</div>
          <div class="slider-group">
            <label>DO Level</label>
            <input type="range" id="do-slider" min="0" max="150" value="80" oninput="doUpdate()">
            <span class="slider-val" id="do-val">8.0 mg/L</span>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-blue">
              <div class="stat-val" id="do-sat">92%</div>
              <div class="stat-label">Saturation</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="do-fish">✓ OK</div>
              <div class="stat-label">Fish Survival</div>
            </div>
            <div class="stat-box stat-amber">
              <div class="stat-val" id="do-temp-effect">Normal</div>
              <div class="stat-label">Temp Effect</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="do-canvas" height="220"></canvas></div>
          <div class="btn-group">
            <button class="btn btn-secondary" onclick="doPreset(85)">Tap Water (~8.5)</button>
            <button class="btn btn-primary" onclick="doPreset(30)">Lemon Juice (~3)</button>
            <button class="btn btn-outline" onclick="doPreset(0)">Anoxic (0)</button>
          </div>
        </div>
      </div>

      <!-- ═══ PART 5: COLORIMETER ═══ -->
      <div class="section" id="colorimeter">
        <div class="section-header">
          <div class="section-num">5</div>
          <div>
            <div class="section-title">Colorimeter</div>
            <div class="section-subtitle">Measure absorbance at 430, 470, 565, and 635 nm wavelengths</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Absorbance Spectrum Comparison</div>
          <div class="btn-group">
            <button class="btn btn-primary" id="color-water-btn" onclick="colorSelect('water')">Tap Water</button>
            <button class="btn btn-secondary" id="color-lemon-btn" onclick="colorSelect('lemon')">Lemon Juice</button>
            <button class="btn btn-outline" id="color-both-btn" onclick="colorSelect('both')">Compare Both</button>
          </div>
          <div class="stat-grid">
            <div class="stat-box" style="border-top:3px solid #7c3aed">
              <div class="stat-val" id="abs-430">0.01</div>
              <div class="stat-label">430 nm (Violet)</div>
            </div>
            <div class="stat-box" style="border-top:3px solid #2563eb">
              <div class="stat-val" id="abs-470">0.01</div>
              <div class="stat-label">470 nm (Blue)</div>
            </div>
            <div class="stat-box" style="border-top:3px solid #16a34a">
              <div class="stat-val" id="abs-565">0.01</div>
              <div class="stat-label">565 nm (Green)</div>
            </div>
            <div class="stat-box" style="border-top:3px solid #dc2626">
              <div class="stat-val" id="abs-635">0.01</div>
              <div class="stat-label">635 nm (Red)</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="color-canvas" height="280"></canvas></div>
        </div>
      </div>

      <!-- ═══ PART 6: TURBIDITY ═══ -->
      <div class="section" id="turbidity">
        <div class="section-header">
          <div class="section-num">6</div>
          <div>
            <div class="section-title">Turbidity Probe</div>
            <div class="section-subtitle">Measure how suspended particles scatter light &mdash; cloudiness of each
              liquid</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Turbidity / Transmittance Visualizer</div>
          <div class="slider-group">
            <label>Turbidity</label>
            <input type="range" id="turb-slider" min="0" max="200" value="5" oninput="turbUpdate()">
            <span class="slider-val" id="turb-val">5 NTU</span>
          </div>
          <div class="stat-grid">
            <div class="stat-box stat-blue">
              <div class="stat-val" id="turb-trans">95%</div>
              <div class="stat-label">Transmittance</div>
            </div>
            <div class="stat-box stat-green">
              <div class="stat-val" id="turb-clarity">Clear</div>
              <div class="stat-label">Clarity</div>
            </div>
            <div class="stat-box stat-amber">
              <div class="stat-val" id="turb-safe">Safe</div>
              <div class="stat-label">Drinking?</div>
            </div>
          </div>
          <div class="chart-wrap"><canvas id="turb-canvas" height="220"></canvas></div>
          <div class="btn-group">
            <button class="btn btn-secondary" onclick="turbPreset(5)">Tap Water (~5)</button>
            <button class="btn btn-primary" onclick="turbPreset(120)">Lemon Juice (~120)</button>
            <button class="btn btn-outline" onclick="turbPreset(0)">Crystal Clear (0)</button>
          </div>
        </div>
      </div>

      <!-- ═══ SUMMARY TABLE ═══ -->
      <div class="section" id="summary">
        <div class="section-header">
          <div class="section-num">7</div>
          <div>
            <div class="section-title">Summary Data Table</div>
            <div class="section-subtitle">Enter your measurements and compare between groups</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Your Group's Data</div>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Measurement</th>
                <th>Tap Water</th>
                <th>Lemon Juice</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>pH</td>
                <td><input type="text" class="data-input" id="s-ph-w" placeholder="e.g. 7.0"></td>
                <td><input type="text" class="data-input" id="s-ph-l" placeholder="e.g. 2.3"></td>
              </tr>
              <tr>
                <td>Conductivity (µS/cm)</td>
                <td><input type="text" class="data-input" id="s-cond-w" placeholder="e.g. 200"></td>
                <td><input type="text" class="data-input" id="s-cond-l" placeholder="e.g. 600"></td>
              </tr>
              <tr>
                <td>Temperature (°C)</td>
                <td><input type="text" class="data-input" id="s-temp-w" placeholder="e.g. 21.5"></td>
                <td><input type="text" class="data-input" id="s-temp-l" placeholder="e.g. 21.3"></td>
              </tr>
              <tr>
                <td>Dissolved O₂ (mg/L)</td>
                <td><input type="text" class="data-input" id="s-do-w" placeholder="e.g. 8.2"></td>
                <td><input type="text" class="data-input" id="s-do-l" placeholder="e.g. 3.1"></td>
              </tr>
              <tr>
                <td>Absorbance (max, Abs)</td>
                <td><input type="text" class="data-input" id="s-abs-w" placeholder="e.g. 0.02"></td>
                <td><input type="text" class="data-input" id="s-abs-l" placeholder="e.g. 1.8"></td>
              </tr>
              <tr>
                <td>Turbidity (NTU)</td>
                <td><input type="text" class="data-input" id="s-turb-w" placeholder="e.g. 3"></td>
                <td><input type="text" class="data-input" id="s-turb-l" placeholder="e.g. 120"></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="card-title">Partner Group's Data</div>
          <table class="summary-table">
            <thead>
              <tr>
                <th>Measurement</th>
                <th>Tap Water</th>
                <th>Lemon Juice</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>pH</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
              <tr>
                <td>Conductivity (µS/cm)</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
              <tr>
                <td>Temperature (°C)</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
              <tr>
                <td>Dissolved O₂ (mg/L)</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
              <tr>
                <td>Absorbance (max, Abs)</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
              <tr>
                <td>Turbidity (NTU)</td>
                <td><input type="text" class="data-input" placeholder="—"></td>
                <td><input type="text" class="data-input" placeholder="—"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- ═══ QUIZ ═══ -->
      <div class="section" id="quiz">
        <div class="section-header">
          <div class="section-num">Q</div>
          <div>
            <div class="section-title">Knowledge Check</div>
            <div class="section-subtitle">Test your understanding &mdash; 10 questions covering all probes</div>
          </div>
        </div>
        <div class="card">
          <div class="card-title">Question <span id="quiz-num">1</span> of 10</div>
          <p id="quiz-question" style="font-size:15px;margin-bottom:12px;font-weight:600;"></p>
          <div id="quiz-options"></div>
          <div class="quiz-feedback" id="quiz-feedback"></div>
          <div class="btn-group">
            <button class="btn btn-secondary" id="quiz-next-btn" onclick="quizNext()" style="display:none">Next Question
              →</button>
          </div>
          <div style="margin-top:12px;font-size:14px">Score: <span class="quiz-score" id="quiz-score">0</span> / <span
              id="quiz-total">0</span></div>
        </div>
      </div>

    </div><!-- /main -->
  </div><!-- /layout -->

  <script>
    // ── Utility ──
    const $ = id => document.getElementById(id);
    const clamp = (v, lo, hi) => Math.max(lo, Math.min(hi, v));

    function getCtx(id) {
      const c = $(id); const dpr = window.devicePixelRatio || 1;
      const w = c.offsetWidth || c.width || 300; const h = c.offsetHeight || c.height || 150;
      c.width = w * dpr; c.height = h * dpr;
      const ctx = c.getContext('2d'); ctx.scale(dpr, dpr);
      ctx.W = w; ctx.H = h; return ctx;
    }

    // ── Sidebar nav ──
    document.querySelectorAll('.sidebar-nav a').forEach(a => {
      a.addEventListener('click', () => {
        document.querySelectorAll('.sidebar-nav a').forEach(x => x.classList.remove('active'));
        a.classList.add('active');
      });
    });

    // ══════════════════════════════════════════════════════════════════
    // PART 1: pH METER
    // ══════════════════════════════════════════════════════════════════
    const phColors = ['#ff0000', '#ff4400', '#ff8800', '#ffaa00', '#ffdd00', '#ccff00', '#66ff00', '#00cc00', '#00aa44', '#0088aa', '#0044cc', '#0000ff', '#2200cc', '#4400aa', '#660088'];

    function phPreset(v) { $('ph-slider').value = v; phUpdate(); }

    function phUpdate() {
      const raw = parseInt($('ph-slider').value);
      const ph = raw / 10;
      $('ph-val').textContent = ph.toFixed(1);
      const hConc = Math.pow(10, -ph);
      $('ph-h').textContent = hConc.toExponential(1);
      if (ph < 3) { $('ph-class').textContent = 'Strongly Acidic'; $('ph-example').textContent = 'Lemon/Stomach'; }
      else if (ph < 6) { $('ph-class').textContent = 'Acidic'; $('ph-example').textContent = 'Coffee/Vinegar'; }
      else if (ph < 6.5) { $('ph-class').textContent = 'Weakly Acidic'; $('ph-example').textContent = 'Milk/Saliva'; }
      else if (ph <= 7.5) { $('ph-class').textContent = 'Neutral'; $('ph-example').textContent = 'Pure Water'; }
      else if (ph <= 9) { $('ph-class').textContent = 'Weakly Basic'; $('ph-example').textContent = 'Baking Soda'; }
      else if (ph <= 12) { $('ph-class').textContent = 'Basic'; $('ph-example').textContent = 'Ammonia/Bleach'; }
      else { $('ph-class').textContent = 'Strongly Basic'; $('ph-example').textContent = 'Drain Cleaner'; }
      drawPhCanvas(ph);
    }

    function drawPhCanvas(ph) {
      const ctx = getCtx('ph-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      // Draw pH gradient bar
      const barH = 40, barY = 30;
      for (let i = 0; i < W; i++) {
        const p = (i / W) * 14;
        const ci = Math.min(14, Math.floor(p));
        ctx.fillStyle = phColors[ci];
        ctx.fillRect(i, barY, 1, barH);
      }
      ctx.strokeStyle = '#374151'; ctx.lineWidth = 2;
      ctx.strokeRect(0, barY, W, barH);
      // Labels
      ctx.font = 'bold 11px system-ui'; ctx.textAlign = 'center'; ctx.fillStyle = '#374151';
      for (let i = 0; i <= 14; i++) {
        const x = (i / 14) * W;
        ctx.fillText(i, x, barY + barH + 16);
        ctx.strokeStyle = '#fff'; ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(x, barY); ctx.lineTo(x, barY + barH); ctx.stroke();
      }
      // Marker
      const mx = (ph / 14) * W;
      ctx.fillStyle = '#1a1a1a'; ctx.beginPath();
      ctx.moveTo(mx, barY - 2); ctx.lineTo(mx - 8, barY - 16); ctx.lineTo(mx + 8, barY - 16); ctx.closePath(); ctx.fill();
      ctx.font = 'bold 14px system-ui'; ctx.fillText('pH ' + ph.toFixed(1), mx, barY - 20);
      // Labels
      ctx.fillStyle = '#c41e3a'; ctx.font = 'bold 13px system-ui'; ctx.textAlign = 'left'; ctx.fillText('ACIDIC', 10, barY + barH + 40);
      ctx.fillStyle = '#16a34a'; ctx.textAlign = 'center'; ctx.fillText('NEUTRAL', W / 2, barY + barH + 40);
      ctx.fillStyle = '#2563eb'; ctx.textAlign = 'right'; ctx.fillText('BASIC', W - 10, barY + barH + 40);
      // H+ visualization
      const numDots = Math.max(1, Math.round(Math.pow(10, 4 - Math.abs(ph - 7)) * (ph < 7 ? 1 : 0.1)));
      const dotCount = Math.min(200, numDots);
      ctx.fillStyle = ph < 7 ? 'rgba(196,30,58,0.5)' : ph > 7 ? 'rgba(37,99,235,0.3)' : 'rgba(100,100,100,0.2)';
      for (let i = 0; i < dotCount; i++) {
        const dx = (i * 137.5 + 50) % W; const dy = barY + barH + 55 + ((i * 97.3) % (H - barY - barH - 65));
        ctx.beginPath(); ctx.arc(dx, dy, 2, 0, Math.PI * 2); ctx.fill();
      }
      ctx.fillStyle = '#64748b'; ctx.font = '11px system-ui'; ctx.textAlign = 'center';
      ctx.fillText(ph < 7 ? 'H⁺ ions (more = more acidic)' : ph > 7 ? 'OH⁻ ions (more = more basic)' : 'Balanced H⁺ and OH⁻', W / 2, H - 8);
    }

    function drawPhCompare() {
      const ctx = getCtx('ph-compare');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      ctx.fillStyle = '#f8fafc'; ctx.fillRect(0, 0, W, H);
      const data = [{ label: 'Tap Water', val: 7, color: '#2563eb' }, { label: 'Lemon Juice', val: 2.3, color: '#c41e3a' }];
      const pad = { top: 25, bottom: 40, left: 60, right: 20 };
      const pw = W - pad.left - pad.right, ph2 = H - pad.top - pad.bottom;
      // Y axis (pH 0-14)
      ctx.strokeStyle = '#e5e7eb'; ctx.lineWidth = 1;
      for (let i = 0; i <= 14; i += 2) {
        const y = pad.top + ph2 * (1 - i / 14);
        ctx.beginPath(); ctx.moveTo(pad.left, y); ctx.lineTo(W - pad.right, y); ctx.stroke();
        ctx.fillStyle = '#9ca3af'; ctx.font = '11px system-ui'; ctx.textAlign = 'right';
        ctx.fillText(i, pad.left - 8, y + 4);
      }
      ctx.fillStyle = '#64748b'; ctx.font = 'bold 12px system-ui'; ctx.textAlign = 'center';
      ctx.save(); ctx.translate(14, H / 2); ctx.rotate(-Math.PI / 2); ctx.fillText('pH', 0, 0); ctx.restore();
      // Neutral line
      const ny = pad.top + ph2 * (1 - 7 / 14);
      ctx.strokeStyle = '#16a34a'; ctx.setLineDash([5, 3]); ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(pad.left, ny); ctx.lineTo(W - pad.right, ny); ctx.stroke();
      ctx.setLineDash([]); ctx.fillStyle = '#16a34a'; ctx.font = '11px system-ui';
      ctx.textAlign = 'left'; ctx.fillText('Neutral (7)', pad.left + 4, ny - 6);
      // Bars
      const barW = pw / data.length * 0.5;
      data.forEach((d, i) => {
        const x = pad.left + (pw / data.length) * i + (pw / data.length - barW) / 2;
        const barH2 = (d.val / 14) * ph2;
        const y = pad.top + ph2 - barH2;
        ctx.fillStyle = d.color;
        ctx.beginPath();
        const r = 4;
        ctx.moveTo(x, pad.top + ph2); ctx.lineTo(x, y + r);
        ctx.quadraticCurveTo(x, y, x + r, y); ctx.lineTo(x + barW - r, y);
        ctx.quadraticCurveTo(x + barW, y, x + barW, y + r); ctx.lineTo(x + barW, pad.top + ph2);
        ctx.closePath(); ctx.fill();
        ctx.fillStyle = '#fff'; ctx.font = 'bold 14px system-ui'; ctx.textAlign = 'center';
        ctx.fillText(d.val.toFixed(1), x + barW / 2, y + 20);
        ctx.fillStyle = '#374151'; ctx.font = 'bold 12px system-ui';
        ctx.fillText(d.label, x + barW / 2, H - pad.bottom + 18);
      });
    }

    // ══════════════════════════════════════════════════════════════════
    // PART 2: CONDUCTIVITY
    // ══════════════════════════════════════════════════════════════════
    function condPreset(v) { $('cond-slider').value = v; condUpdate(); }

    function condUpdate() {
      const raw = parseInt($('cond-slider').value);
      const uS = raw * 10; // 0-1000 µS/cm range
      $('cond-val').textContent = uS + ' µS';
      $('cond-tds').textContent = Math.round(uS * 0.5);
      if (uS < 50) { $('cond-quality').textContent = 'Ultra Pure'; $('cond-current').textContent = 'Very Low'; }
      else if (uS < 300) { $('cond-quality').textContent = 'Good'; $('cond-current').textContent = 'Low'; }
      else if (uS < 800) { $('cond-quality').textContent = 'Moderate'; $('cond-current').textContent = 'Medium'; }
      else { $('cond-quality').textContent = 'High TDS'; $('cond-current').textContent = 'High'; }
      drawCondCanvas(uS);
    }

    function drawCondCanvas(uS) {
      const ctx = getCtx('cond-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      // Water background
      ctx.fillStyle = `rgba(173,216,230,${0.2 + Math.min(0.5, uS / 2000)})`;
      ctx.fillRect(0, 0, W, H);
      // Electrodes
      ctx.fillStyle = '#64748b';
      ctx.fillRect(W * 0.2 - 4, 20, 8, H - 40);
      ctx.fillRect(W * 0.8 - 4, 20, 8, H - 40);
      ctx.fillStyle = '#374151'; ctx.font = 'bold 11px system-ui'; ctx.textAlign = 'center';
      ctx.fillText('(−)', W * 0.2, 14); ctx.fillText('(+)', W * 0.8, 14);
      // Ions
      const numIons = Math.min(80, Math.floor(uS / 12));
      for (let i = 0; i < numIons; i++) {
        const ix = W * 0.25 + ((i * 137.5) % (W * 0.5));
        const iy = 30 + ((i * 97.3 + 50) % (H - 60));
        const isPositive = i % 2 === 0;
        ctx.fillStyle = isPositive ? 'rgba(196,30,58,0.6)' : 'rgba(37,99,235,0.6)';
        ctx.beginPath(); ctx.arc(ix, iy, 4, 0, Math.PI * 2); ctx.fill();
        ctx.fillStyle = '#fff'; ctx.font = 'bold 7px system-ui'; ctx.textAlign = 'center';
        ctx.fillText(isPositive ? '+' : '−', ix, iy + 3);
      }
      // Current arrows if conducting
      if (uS > 30) {
        const intensity = Math.min(1, uS / 500);
        ctx.strokeStyle = `rgba(217,119,6,${intensity})`; ctx.lineWidth = 2;
        const arrows = Math.min(5, Math.ceil(uS / 200));
        for (let i = 0; i < arrows; i++) {
          const ay = 50 + (H - 100) / (arrows + 1) * (i + 1);
          ctx.beginPath(); ctx.moveTo(W * 0.25, ay); ctx.lineTo(W * 0.75, ay); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(W * 0.75, ay); ctx.lineTo(W * 0.75 - 10, ay - 5); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(W * 0.75, ay); ctx.lineTo(W * 0.75 - 10, ay + 5); ctx.stroke();
        }
        ctx.fillStyle = `rgba(217,119,6,${intensity})`; ctx.font = 'bold 12px system-ui';
        ctx.textAlign = 'center'; ctx.fillText('Current Flow →', W / 2, H - 10);
      } else {
        ctx.fillStyle = '#94a3b8'; ctx.font = '12px system-ui'; ctx.textAlign = 'center';
        ctx.fillText('No significant current', W / 2, H - 10);
      }
      ctx.fillStyle = '#374151'; ctx.font = 'bold 13px system-ui'; ctx.textAlign = 'center';
      ctx.fillText(uS + ' µS/cm', W / 2, H - 28);
    }

    // ══════════════════════════════════════════════════════════════════
    // PART 3: TEMPERATURE
    // ══════════════════════════════════════════════════════════════════
    function tempUpdate() {
      const c = parseInt($('temp-slider').value);
      $('temp-val').textContent = c.toFixed(1) + '°C';
      $('temp-f').textContent = (c * 9 / 5 + 32).toFixed(1) + '°F';
      $('temp-k').textContent = (c + 273.15).toFixed(1) + ' K';
      if (c <= 0) $('temp-bio').textContent = 'Freezing';
      else if (c < 15) $('temp-bio').textContent = 'Cold';
      else if (c < 25) $('temp-bio').textContent = 'Room Temp';
      else if (c < 37) $('temp-bio').textContent = 'Warm';
      else if (c < 38) $('temp-bio').textContent = 'Body Temp';
      else if (c < 45) $('temp-bio').textContent = 'Fever Range';
      else $('temp-bio').textContent = 'Hot/Danger';
      drawTempCanvas(c);
    }

    function drawTempCanvas(temp) {
      const ctx = getCtx('temp-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      ctx.fillStyle = '#f8fafc'; ctx.fillRect(0, 0, W, H);
      // Thermometer (left half)
      const tx = W * 0.25, ty = 30, tw = 24, th = H - 80;
      const bulbR = 18; const bulbY = ty + th;
      // Tube
      ctx.fillStyle = '#e5e7eb';
      ctx.beginPath(); ctx.roundRect(tx - tw / 2, ty, tw, th, 8); ctx.fill();
      // Mercury level
      const frac = clamp(temp / 100, 0, 1);
      const mercH = th * frac;
      ctx.fillStyle = '#c41e3a';
      ctx.fillRect(tx - tw / 2 + 3, ty + th - mercH, tw - 6, mercH);
      // Bulb
      ctx.fillStyle = '#c41e3a'; ctx.beginPath(); ctx.arc(tx, bulbY, bulbR, 0, Math.PI * 2); ctx.fill();
      ctx.strokeStyle = '#9ca3af'; ctx.lineWidth = 1; ctx.beginPath(); ctx.roundRect(tx - tw / 2, ty, tw, th, 8); ctx.stroke();
      // Scale marks
      ctx.fillStyle = '#64748b'; ctx.font = '11px system-ui'; ctx.textAlign = 'left';
      for (let i = 0; i <= 100; i += 20) {
        const y = ty + th * (1 - i / 100);
        ctx.beginPath(); ctx.moveTo(tx + tw / 2 + 2, y); ctx.lineTo(tx + tw / 2 + 10, y); ctx.stroke();
        ctx.fillText(i + '°', tx + tw / 2 + 14, y + 4);
      }
      // Digital display (right half)
      ctx.fillStyle = '#1a1a2e';
      ctx.beginPath(); ctx.roundRect(W * 0.55, H * 0.2, W * 0.35, H * 0.35, 10); ctx.fill();
      ctx.fillStyle = '#00ff88'; ctx.font = 'bold 36px ' + getComputedStyle(document.body).getPropertyValue('--mono');
      ctx.textAlign = 'center'; ctx.fillText(temp.toFixed(1) + '°C', W * 0.55 + W * 0.175, H * 0.2 + H * 0.22);
      ctx.fillStyle = '#64748b'; ctx.font = '12px system-ui';
      ctx.fillText('Digital Probe', W * 0.55 + W * 0.175, H * 0.2 + H * 0.35 + 18);
      ctx.fillText('Mercury Thermometer', tx, bulbY + bulbR + 18);
    }

    // ══════════════════════════════════════════════════════════════════
    // PART 4: DISSOLVED OXYGEN
    // ══════════════════════════════════════════════════════════════════
    function doPreset(v) { $('do-slider').value = v; doUpdate(); }

    function doUpdate() {
      const raw = parseInt($('do-slider').value);
      const doVal = raw / 10;
      $('do-val').textContent = doVal.toFixed(1) + ' mg/L';
      const sat = Math.min(100, Math.round(doVal / 8.7 * 100));
      $('do-sat').textContent = sat + '%';
      $('do-fish').textContent = doVal >= 4 ? '✓ OK' : '✗ Low';
      $('do-fish').style.color = doVal >= 4 ? 'var(--green)' : 'var(--accent)';
      if (doVal > 9) $('do-temp-effect').textContent = 'Cold water';
      else if (doVal > 6) $('do-temp-effect').textContent = 'Normal';
      else if (doVal > 3) $('do-temp-effect').textContent = 'Warm/Acidic';
      else $('do-temp-effect').textContent = 'Depleted';
      drawDoCanvas(doVal);
    }

    function drawDoCanvas(doVal) {
      const ctx = getCtx('do-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      // Water
      ctx.fillStyle = 'rgba(173,216,230,0.3)'; ctx.fillRect(0, 0, W, H);
      // O2 bubbles
      const numBubbles = Math.min(60, Math.round(doVal * 5));
      for (let i = 0; i < numBubbles; i++) {
        const bx = (i * 137.5 + 30) % W;
        const by = (i * 97.3 + 20) % H;
        const br = 3 + Math.random() * 4;
        ctx.fillStyle = 'rgba(37,99,235,0.15)';
        ctx.beginPath(); ctx.arc(bx, by, br, 0, Math.PI * 2); ctx.fill();
        ctx.strokeStyle = 'rgba(37,99,235,0.3)'; ctx.lineWidth = 1; ctx.stroke();
      }
      // Gauge
      const gx = W / 2, gy = H - 40, gr = Math.min(W, H) * 0.32;
      const startA = Math.PI * 0.8, endA = Math.PI * 0.2;
      const range = (2 * Math.PI) - (startA - endA);
      ctx.strokeStyle = '#e5e7eb'; ctx.lineWidth = 16; ctx.lineCap = 'round';
      ctx.beginPath(); ctx.arc(gx, gy, gr, startA, endA + 2 * Math.PI); ctx.stroke();
      // Filled arc
      const frac = clamp(doVal / 15, 0, 1);
      const fillEnd = startA + frac * range;
      const gaugeColor = doVal < 4 ? '#c41e3a' : doVal < 7 ? '#d97706' : '#16a34a';
      ctx.strokeStyle = gaugeColor; ctx.lineWidth = 16;
      ctx.beginPath(); ctx.arc(gx, gy, gr, startA, fillEnd); ctx.stroke();
      // Value
      ctx.fillStyle = '#1a1a1a'; ctx.font = 'bold 28px system-ui'; ctx.textAlign = 'center';
      ctx.fillText(doVal.toFixed(1), gx, gy - 10);
      ctx.fillStyle = '#64748b'; ctx.font = '13px system-ui';
      ctx.fillText('mg/L Dissolved O₂', gx, gy + 12);
      // Fish threshold
      ctx.fillStyle = '#94a3b8'; ctx.font = '11px system-ui';
      ctx.fillText('Fish need ≥ 4 mg/L', gx, gy + gr + 20);
    }

    // ══════════════════════════════════════════════════════════════════
    // PART 5: COLORIMETER
    // ══════════════════════════════════════════════════════════════════
    const colorData = {
      water: { 430: 0.01, 470: 0.01, 565: 0.01, 635: 0.01 },
      lemon: { 430: 1.85, 470: 1.20, 565: 0.45, 635: 0.30 }
    };
    let colorMode = 'both';

    function colorSelect(mode) { colorMode = mode; updateColorStats(); drawColorCanvas(); }

    function updateColorStats() {
      const d = colorMode === 'lemon' ? colorData.lemon : colorData.water;
      $('abs-430').textContent = d[430].toFixed(2);
      $('abs-470').textContent = d[470].toFixed(2);
      $('abs-565').textContent = d[565].toFixed(2);
      $('abs-635').textContent = d[635].toFixed(2);
    }

    function drawColorCanvas() {
      const ctx = getCtx('color-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      ctx.fillStyle = '#f8fafc'; ctx.fillRect(0, 0, W, H);
      const wl = [430, 470, 565, 635];
      const wlColors = ['#7c3aed', '#2563eb', '#16a34a', '#dc2626'];
      const wlLabels = ['430nm\nViolet', '470nm\nBlue', '565nm\nGreen', '635nm\nRed'];
      const pad = { top: 30, bottom: 50, left: 55, right: 20 };
      const pw = W - pad.left - pad.right, ph2 = H - pad.top - pad.bottom;
      const maxAbs = 2.0;
      // Grid
      ctx.strokeStyle = '#e5e7eb'; ctx.lineWidth = 1;
      for (let i = 0; i <= 4; i++) {
        const y = pad.top + ph2 * (1 - i / 4);
        ctx.beginPath(); ctx.moveTo(pad.left, y); ctx.lineTo(W - pad.right, y); ctx.stroke();
        ctx.fillStyle = '#9ca3af'; ctx.font = '11px system-ui'; ctx.textAlign = 'right';
        ctx.fillText((maxAbs * i / 4).toFixed(1), pad.left - 8, y + 4);
      }
      ctx.fillStyle = '#64748b'; ctx.font = 'bold 11px system-ui';
      ctx.save(); ctx.translate(14, H / 2); ctx.rotate(-Math.PI / 2); ctx.textAlign = 'center'; ctx.fillText('Absorbance', 0, 0); ctx.restore();
      // Bars
      const showW = colorMode !== 'lemon';
      const showL = colorMode !== 'water';
      const groupW2 = pw / wl.length;
      const barW2 = showW && showL ? groupW2 * 0.35 : groupW2 * 0.5;
      wl.forEach((w, i) => {
        const gx = pad.left + groupW2 * i;
        if (showW) {
          const bx = showL ? gx + groupW2 * 0.1 : gx + (groupW2 - barW2) / 2;
          const v = colorData.water[w]; const bh = (v / maxAbs) * ph2;
          ctx.fillStyle = wlColors[i] + '44';
          ctx.fillRect(bx, pad.top + ph2 - bh, barW2, bh);
          ctx.strokeStyle = wlColors[i]; ctx.lineWidth = 1; ctx.strokeRect(bx, pad.top + ph2 - bh, barW2, bh);
          if (v > 0.005) { ctx.fillStyle = '#374151'; ctx.font = '10px system-ui'; ctx.textAlign = 'center'; ctx.fillText(v.toFixed(2), bx + barW2 / 2, pad.top + ph2 - bh - 4); }
        }
        if (showL) {
          const bx = showW ? gx + groupW2 * 0.55 : gx + (groupW2 - barW2) / 2;
          const v = colorData.lemon[w]; const bh = (v / maxAbs) * ph2;
          ctx.fillStyle = wlColors[i];
          ctx.beginPath();
          const r = 3;
          ctx.moveTo(bx, pad.top + ph2); ctx.lineTo(bx, pad.top + ph2 - bh + r);
          ctx.quadraticCurveTo(bx, pad.top + ph2 - bh, bx + r, pad.top + ph2 - bh);
          ctx.lineTo(bx + barW2 - r, pad.top + ph2 - bh);
          ctx.quadraticCurveTo(bx + barW2, pad.top + ph2 - bh, bx + barW2, pad.top + ph2 - bh + r);
          ctx.lineTo(bx + barW2, pad.top + ph2); ctx.closePath(); ctx.fill();
          ctx.fillStyle = '#fff'; ctx.font = 'bold 11px system-ui'; ctx.textAlign = 'center';
          if (bh > 20) ctx.fillText(v.toFixed(2), bx + barW2 / 2, pad.top + ph2 - bh + 16);
        }
        ctx.fillStyle = '#374151'; ctx.font = '11px system-ui'; ctx.textAlign = 'center';
        ctx.fillText(w + 'nm', gx + groupW2 / 2, H - pad.bottom + 16);
      });
      // Legend
      if (showW && showL) {
        ctx.fillStyle = '#2563eb44'; ctx.fillRect(W - 140, 8, 12, 12);
        ctx.fillStyle = '#374151'; ctx.font = '11px system-ui'; ctx.textAlign = 'left'; ctx.fillText('Tap Water', W - 124, 18);
        ctx.fillStyle = '#2563eb'; ctx.fillRect(W - 140, 24, 12, 12);
        ctx.fillText('Lemon Juice', W - 124, 34);
      }
    }

    // ══════════════════════════════════════════════════════════════════
    // PART 6: TURBIDITY
    // ══════════════════════════════════════════════════════════════════
    function turbPreset(v) { $('turb-slider').value = v; turbUpdate(); }

    function turbUpdate() {
      const ntu = parseInt($('turb-slider').value);
      $('turb-val').textContent = ntu + ' NTU';
      const trans = Math.max(0, 100 - ntu * 0.5);
      $('turb-trans').textContent = trans.toFixed(0) + '%';
      if (ntu < 5) { $('turb-clarity').textContent = 'Clear'; $('turb-safe').textContent = 'Safe'; }
      else if (ntu < 20) { $('turb-clarity').textContent = 'Slight Haze'; $('turb-safe').textContent = 'Safe'; }
      else if (ntu < 50) { $('turb-clarity').textContent = 'Hazy'; $('turb-safe').textContent = 'Marginal'; }
      else if (ntu < 100) { $('turb-clarity').textContent = 'Cloudy'; $('turb-safe').textContent = 'Unsafe'; }
      else { $('turb-clarity').textContent = 'Very Cloudy'; $('turb-safe').textContent = 'Unsafe'; }
      drawTurbCanvas(ntu);
    }

    function drawTurbCanvas(ntu) {
      const ctx = getCtx('turb-canvas');
      const W = ctx.W, H = ctx.H;
      ctx.clearRect(0, 0, W, H);
      // Cuvette
      const cx = W * 0.3, cw = W * 0.4, cy = 20, ch = H - 40;
      const opacity = Math.min(0.9, ntu / 200);
      ctx.fillStyle = `rgba(210,190,120,${opacity})`;
      ctx.fillRect(cx, cy, cw, ch);
      ctx.strokeStyle = '#94a3b8'; ctx.lineWidth = 2; ctx.strokeRect(cx, cy, cw, ch);
      // Particles
      const numP = Math.min(100, Math.round(ntu * 0.6));
      for (let i = 0; i < numP; i++) {
        const px = cx + 10 + ((i * 137.5) % (cw - 20));
        const py = cy + 10 + ((i * 97.3) % (ch - 20));
        ctx.fillStyle = 'rgba(139,119,42,0.5)';
        ctx.beginPath(); ctx.arc(px, py, 1.5 + Math.random() * 2, 0, Math.PI * 2); ctx.fill();
      }
      // Light beam
      ctx.fillStyle = '#ffd700'; ctx.globalAlpha = 0.8;
      ctx.fillRect(10, H / 2 - 4, cx - 10, 8);
      // Transmitted light
      const transAlpha = Math.max(0.05, 1 - ntu / 200);
      ctx.fillStyle = '#ffd700'; ctx.globalAlpha = transAlpha;
      ctx.fillRect(cx + cw, H / 2 - 4, W - cx - cw - 10, 8);
      ctx.globalAlpha = 1;
      // Scattered light (if turbid)
      if (ntu > 10) {
        ctx.strokeStyle = `rgba(255,215,0,${Math.min(0.5, ntu / 200)})`;
        ctx.lineWidth = 1;
        for (let i = 0; i < Math.min(8, ntu / 15); i++) {
          const sx = cx + cw / 2 + (Math.random() - 0.5) * cw * 0.6;
          const sy = H / 2;
          const angle = (Math.random() - 0.5) * Math.PI * 0.8;
          ctx.beginPath(); ctx.moveTo(sx, sy);
          ctx.lineTo(sx + Math.cos(angle) * 40, sy + Math.sin(angle) * 40); ctx.stroke();
        }
      }
      // Labels
      ctx.fillStyle = '#374151'; ctx.font = 'bold 12px system-ui'; ctx.textAlign = 'center';
      ctx.fillText('Light Source', cx / 2, H / 2 + 24);
      ctx.fillText('Sample', cx + cw / 2, cy - 6);
      ctx.fillText('Detector', cx + cw + (W - cx - cw) / 2, H / 2 + 24);
      ctx.fillText(ntu + ' NTU | ' + (100 - Math.min(100, ntu * 0.5)).toFixed(0) + '% T', W / 2, H - 8);
    }

    // ══════════════════════════════════════════════════════════════════
    // QUIZ
    // ══════════════════════════════════════════════════════════════════
    const quizData = [
      { q: 'What does pH measure?', opts: ['Temperature of a solution', 'Hydrogen ion concentration', 'Dissolved oxygen level', 'Light absorbance'], ans: 1 },
      { q: 'Lemon juice has a pH of about 2. Tap water has a pH of about 7. How many times more H⁺ ions does lemon juice have?', opts: ['5 times', '50 times', '100,000 times', '7 times'], ans: 2 },
      { q: 'What does a conductivity probe measure?', opts: ['Temperature changes', 'How well a solution conducts electricity', 'Light transmittance', 'Dissolved oxygen'], ans: 1 },
      { q: 'Why would lemon juice have higher conductivity than distilled water?', opts: ['It is colder', 'It contains dissolved ions (citric acid, minerals)', 'It absorbs more light', 'It has more oxygen'], ans: 1 },
      { q: 'What unit is dissolved oxygen measured in?', opts: ['pH units', 'µS/cm', 'mg/L', 'NTU'], ans: 2 },
      { q: 'Fish need at least 4-5 mg/L of dissolved oxygen. Which factor DECREASES dissolved oxygen?', opts: ['Cold temperature', 'Higher altitude', 'Lower water temperature', 'All of the above can decrease DO'], ans: 3 },
      { q: 'A colorimeter measures absorbance at different wavelengths. Why would lemon juice absorb more light at 430 nm (violet) than 635 nm (red)?', opts: ['Lemon juice appears yellow, which absorbs violet/blue light', 'Violet light is slower', 'Red light has more energy', 'The colorimeter is broken'], ans: 0 },
      { q: 'What does high turbidity indicate about a liquid?', opts: ['It is very acidic', 'It contains many suspended particles', 'It is very cold', 'It has no dissolved gases'], ans: 1 },
      { q: 'Why must you rinse probes with distilled water between samples?', opts: ['To keep the probe wet', 'To avoid cross-contamination of measurements', 'To calibrate the probe', 'Probes only work when wet'], ans: 1 },
      { q: 'After collecting all data, why do groups share and compare their results?', opts: ['To save time', 'To verify reproducibility and identify measurement errors', 'Because the instructor requires it', 'To average out the probe readings'], ans: 1 }
    ];
    let quizIdx = 0, quizScore = 0, quizAnswered = 0;

    function quizRender() {
      const q = quizData[quizIdx];
      $('quiz-num').textContent = quizIdx + 1;
      $('quiz-question').textContent = q.q;
      const optDiv = $('quiz-options');
      optDiv.innerHTML = '';
      q.opts.forEach((o, i) => {
        const btn = document.createElement('button');
        btn.className = 'quiz-option';
        btn.textContent = String.fromCharCode(65 + i) + '. ' + o;
        btn.onclick = () => quizAnswer(i);
        optDiv.appendChild(btn);
      });
      $('quiz-feedback').style.display = 'none';
      $('quiz-next-btn').style.display = 'none';
    }

    function quizAnswer(idx) {
      const q = quizData[quizIdx];
      const opts = $('quiz-options').querySelectorAll('.quiz-option');
      opts.forEach((o, i) => {
        o.disabled = true;
        o.style.pointerEvents = 'none';
        if (i === q.ans) o.classList.add('correct');
        if (i === idx && i !== q.ans) o.classList.add('wrong');
      });
      const fb = $('quiz-feedback');
      fb.style.display = 'block';
      if (idx === q.ans) {
        quizScore++;
        fb.textContent = '✓ Correct!';
        fb.style.background = '#f0fdf4'; fb.style.color = '#16a34a';
      } else {
        fb.textContent = '✗ Incorrect. The correct answer is ' + String.fromCharCode(65 + q.ans) + '.';
        fb.style.background = '#fef2f2'; fb.style.color = '#c41e3a';
      }
      quizAnswered++;
      $('quiz-score').textContent = quizScore;
      $('quiz-total').textContent = quizAnswered;
      if (quizIdx < quizData.length - 1) $('quiz-next-btn').style.display = 'inline-flex';
    }

    function quizNext() {
      quizIdx++;
      quizRender();
    }

    // ── INIT ──
    function init() {
      phUpdate();
      drawPhCompare();
      condUpdate();
      tempUpdate();
      doUpdate();
      colorSelect('both');
      turbUpdate();
      quizRender();
    }
    init();
    window.addEventListener('resize', () => { drawPhCompare(); drawColorCanvas(); });
  </script>
</body>

</html>